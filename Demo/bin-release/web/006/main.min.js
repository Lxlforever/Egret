var Main=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.createChildren=function(){t.prototype.createChildren.call(this),this.stage.registerImplementation("eui.IAssetAdapter",new AssetAdapter),this.stage.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},n.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this);var e=new eui.Theme("resource/default.thm.json",this.stage);e.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this)},n.onThemeLoadComplete=function(){this.initScene(),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("preload")},n.onResourceLoadComplete=function(t){"preload"==t.groupName?(App.ControllerManager.register(ControllerConst.Loading,new LoadingController),App.SceneManager.runScene(SceneConst.Loading),RES.loadGroup("loading")):"loading"==t.groupName&&(RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.start())},n.start=function(){App.Init(),App.ControllerManager.register(ControllerConst.Game,new GameController),App.SceneManager.runScene(SceneConst.Game)},n.initScene=function(){App.SceneManager.register(SceneConst.Loading,new LoadingScene),App.SceneManager.register(SceneConst.Game,new GameScene)},n.onResourceProgress=function(t){"loading"==t.groupName&&App.ControllerManager.applyFunc(ControllerConst.Loading,LoadingConst.SetProgress,t.itemsLoaded,t.itemsTotal)},n.onItemLoadError=function(t){console.warn("Url:"+t.resItem.url+" has failed to load")},n.onResourceLoadError=function(t){console.warn("Group:"+t.groupName+" has failed to load"),this.onResourceLoadComplete(t)},e}(eui.UILayer);egret.registerClass(Main,"Main");var App=function(){function t(){}var e=__define,i=t;i.prototype;return e(t,"Http",function(){return Http.getInstance()}),e(t,"Socket",function(){return Socket.getInstance()}),e(t,"ControllerManager",function(){return ControllerManager.getInstance()}),e(t,"ViewManager",function(){return ViewManager.getInstance()}),e(t,"SceneManager",function(){return SceneManager.getInstance()}),e(t,"DebugUtils",function(){return DebugUtils.getInstance()}),e(t,"MessageCenter",function(){return MessageCenter.getInstance(0)}),e(t,"TimerManager",function(){return TimerManager.getInstance()}),e(t,"DateUtils",function(){return DateUtils.getInstance()}),e(t,"MathUtils",function(){return MathUtils.getInstance()}),e(t,"RandomUtils",function(){return RandomUtils.getInstance()}),e(t,"DisplayUtils",function(){return DisplayUtils.getInstance()}),e(t,"BitmapNumber",function(){return BitmapNumber.getInstance()}),e(t,"GuideUtils",function(){return GuideUtils.getInstance()}),e(t,"StageUtils",function(){return StageUtils.getInstance()}),e(t,"EffectUtils",function(){return EffectUtils.getInstance()}),e(t,"StringUtils",function(){return StringUtils.getInstance()}),e(t,"CommonUtils",function(){return CommonUtils.getInstance()}),e(t,"SoundManager",function(){return SoundManager.getInstance()}),e(t,"DeviceUtils",function(){return DeviceUtils.getInstance()}),e(t,"EgretExpandUtils",function(){return EgretExpandUtils.getInstance()}),e(t,"KeyboardUtils",function(){return KeyboardUtils.getInstance()}),e(t,"RockerUtils",function(){return RockerUtils.getInstance()}),e(t,"ShockUtils",function(){return ShockUtils.getInstance()}),e(t,"ResourceUtils",function(){return ResourceUtils.getInstance()}),e(t,"RenderTextureManager",function(){return RenderTextureManager.getInstance()}),e(t,"TextFlowMaker",function(){return TextFlowMaker.getInstance()}),e(t,"NotificationCenter",function(){return null==t._notificationCenter&&(t._notificationCenter=new MessageCenter(1)),t._notificationCenter}),e(t,"DelayOptManager",function(){return DelayOptManager.getInstance()}),e(t,"ArrayUtils",function(){return ArrayUtils.getInstance()}),e(t,"EasyLoading",function(){return EasyLoading.getInstance()}),e(t,"ResVersionManager",function(){return ResVersionManager.getInstance()}),e(t,"DragonBonesFactory",function(){return DragonBonesFactory.getInstance()}),e(t,"StarlingSwfFactory",function(){return StarlingSwfFactory.getInstance()}),t.Init=function(){t.GlobalData=RES.getRes("global_json"),t.DebugUtils.isOpen(t.GlobalData.IsDebug),t.DebugUtils.setThreshold(5),t.EgretExpandUtils.init()},t.ProxyUserFlag="",t.GlobalData=null,t.ProtoFile=null,t.ProtoConfig=null,t}();egret.registerClass(App,"App");var AssetAdapter=function(){function t(){}var e=(__define,t),i=e.prototype;return i.getAsset=function(t,e,i){function n(n){e.call(i,n,t)}if(RES.hasRes(t)){var s=RES.getRes(t);s?n(s):RES.getResAsync(t,n,this)}else RES.getResByUrl(t,n,this,RES.ResourceItem.TYPE_IMAGE)},t}();egret.registerClass(AssetAdapter,"AssetAdapter",["eui.IAssetAdapter"]);var MergeJsonAnalyzer=function(t){function e(){t.apply(this,arguments),this.mergeJsons=["MergeConfig_json"]}__extends(e,t);var i=(__define,e),n=i.prototype;return n.analyzeData=function(t,e){var i=t.name;if(!this.fileDic[i]&&e)try{var n=JSON.parse(e);if(-1!=this.mergeJsons.indexOf(i))for(var s in n)this.fileDic[s]=n[s];else this.fileDic[i]=n}catch(r){egret.$warn(1017,t.url,e)}},e}(RES.JsonAnalyzer);egret.registerClass(MergeJsonAnalyzer,"MergeJsonAnalyzer");var ThemeAdapter=function(){function t(){}var e=(__define,t),i=e.prototype;return i.getTheme=function(t,e,i,n){function s(t){e.call(n,t)}function r(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),i.call(n))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),RES.getResByUrl(t,s,this,RES.ResourceItem.TYPE_TEXT)},t}();egret.registerClass(ThemeAdapter,"ThemeAdapter",["eui.IThemeAdapter"]);var BaseClass=function(){function t(){}var e=(__define,t);e.prototype;return t.getInstance=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];var i=this;if(!i._instance){var n=t.length;0==n?i._instance=new i:1==n?i._instance=new i(t[0]):2==n?i._instance=new i(t[0],t[1]):3==n?i._instance=new i(t[0],t[1],t[2]):4==n?i._instance=new i(t[0],t[1],t[2],t[3]):5==n&&(i._instance=new i(t[0],t[1],t[2],t[3],t[4]))}return i._instance},t}();egret.registerClass(BaseClass,"BaseClass");var Keyboard=function(){function t(){}var e=(__define,t);e.prototype;return t.LEFT=37,t.RIGHT=39,t.UP=38,t.DOWN=40,t.W=87,t.A=65,t.S=83,t.D=68,t.J=74,t.K=75,t.L=76,t.U=85,t.I=73,t.O=79,t.P=80,t.SPACE=32,t}();egret.registerClass(Keyboard,"Keyboard");var BitmapNumber=function(t){function e(){t.call(this),this._imgPool=[],this._containerPool=[]}__extends(e,t);var i=(__define,e),n=i.prototype;return n.createNumPic=function(t,e){var i,n=this.getContainer(),s=t.toString(),r=0;for(r;r<s.length;r++)i=this.getSingleNumPic(s.charAt(r),e),n.addChild(i);return this.repositionNumPic(n),n},n.desstroyNumPic=function(t){this.clearContainer(t),t.parent&&t.parent.removeChild(t),this._containerPool.push(t)},n.changeNum=function(t,e,i){var n=e.toString();if(t.numChildren>n.length)for(;t.numChildren>n.length;)this.recycleBM(t.getChildAt(t.numChildren-1));var s,r=0;for(r;r<n.length;r++)r>=t.numChildren&&t.addChild(this.getBitmap()),s=n.charAt(r),s="."==s?"dot":s,t.getChildAt(r).texture=this.getTexture(s,i);this.repositionNumPic(t)},n.repositionNumPic=function(t){var e,i=0,n=0;for(i;i<t.numChildren;i++)e=t.getChildAt(i),e.x=n,n=e.x+e.width},n.clearContainer=function(t){for(;t.numChildren;)this.recycleBM(t.removeChildAt(0))},n.recycleBM=function(t){t&&t.parent&&(t.parent.removeChild(t),t.texture=null,this._imgPool.push(t))},n.getContainer=function(){return this._containerPool.length?this._containerPool.shift():new egret.DisplayObjectContainer},n.getSingleNumPic=function(t,e){"."==t&&(t="dot");var i=this.getBitmap();return i.texture=this.getTexture(t,e),i},n.getTexture=function(t,e){return RES.getRes(e+t)},n.getBitmap=function(){return this._imgPool.length?this._imgPool.shift():new egret.Bitmap},e}(BaseClass);egret.registerClass(BitmapNumber,"BitmapNumber");var HotspotBitmap=function(t){function e(){t.call(this),this._hotspot=[],this.touchEnabled=!0,this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouch,this)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.addHotspotArea=function(t,e,i,n){this._hotspot.push({rect:t,callBack:e,thisObj:i,para:n})},n.onTouch=function(t){for(var e,i=t.localX,n=t.localY,s=0;s<this._hotspot.length;s++)e=this._hotspot[s],e.rect.contains(i,n)&&(e.para?e.callBack.call(e.thisObj,e.para):e.callBack.call(e.thisObj))},e}(egret.Bitmap);egret.registerClass(HotspotBitmap,"HotspotBitmap");var DragonBonesArmature=function(t){function e(e,i){t.call(this),this._armature=e,this._clock=i,this.addChild(this._armature.display),this._completeCalls=[],this._frameCalls=[],this._isPlay=!1,this._playName=""}__extends(e,t);var i=(__define,e),n=i.prototype;return n.addListeners=function(){this._armature.addEventListener(dragonBones.AnimationEvent.COMPLETE,this.completeHandler,this),this._armature.enableCache?this._armature.addEventListener(dragonBones.FrameEvent.ANIMATION_FRAME_EVENT,this.frameHandler,this):this._armature.addEventListener(dragonBones.FrameEvent.BONE_FRAME_EVENT,this.frameHandler,this)},n.removeListeners=function(){this._armature.removeEventListener(dragonBones.AnimationEvent.COMPLETE,this.completeHandler,this),this._armature.enableCache?this._armature.removeEventListener(dragonBones.FrameEvent.ANIMATION_FRAME_EVENT,this.frameHandler,this):this._armature.removeEventListener(dragonBones.FrameEvent.BONE_FRAME_EVENT,this.frameHandler,this)},n.completeHandler=function(t){var e=t.animationName;t.armature instanceof dragonBones.Armature&&(e=t.animationState.animationData.name);for(var i=0,n=this._completeCalls.length;n>i;i++){var s=this._completeCalls[i];s[0].apply(s[1],[t,e])}e==this._playName&&(this._playName="")},n.frameHandler=function(t){for(var e=0,i=this._frameCalls.length;i>e;e++){var n=this._frameCalls[e];n[0].apply(n[1],[t])}},n.play=function(t,e){return void 0===e&&(e=void 0),this._playName==t?this._currAnimationState:(this._playName=t,this.start(),void 0==e?this._currAnimationState=this.getAnimation().gotoAndPlay(t):this._currAnimationState=this.getAnimation().gotoAndPlay(t,void 0,void 0,e),this._currAnimationState&&(this._currAnimationState.autoTween=!1),this._currAnimationState)},n.start=function(){this._isPlay||(this._clock.add(this._armature),this._isPlay=!0,this.addListeners())},n.stop=function(){this._isPlay&&(this._clock.remove(this._armature),this._isPlay=!1,this._playName="",this.removeListeners())},n.destroy=function(){this.stop(),this.parent&&this.parent.removeChild(this),this.removeChildren(),this._armature=null,this._clock=null,this._completeCalls=null,this._frameCalls=null},n.addCompleteCallFunc=function(t,e){for(var i=0;i<this._completeCalls.length;i++){var n=this._completeCalls[i];if(n[0]==t&&n[1]==e)return}this._completeCalls.unshift([t,e])},n.removeCompleteCallFunc=function(t,e){for(var i=0;i<this._completeCalls.length;i++){var n=this._completeCalls[i];n[0]==t&&n[1]==e&&(this._completeCalls.splice(i,1),i--)}},n.addFrameCallFunc=function(t,e){for(var i=0;i<this._frameCalls.length;i++){var n=this._frameCalls[i];if(n[0]==t&&n[1]==e)return}this._frameCalls.push([t,e])},n.removeFrameCallFunc=function(t,e){for(var i=0;i<this._frameCalls.length;i++){var n=this._frameCalls[i];n[0]==t&&n[1]==e&&(this._frameCalls.splice(i,1),i--)}},n.$onRemoveFromStage=function(){t.prototype.$onRemoveFromStage.call(this),this.stop()},n.getArmature=function(){return this._armature},n.getCurrAnimationState=function(){return this._currAnimationState},n.getClock=function(){return this._clock},n.getAnimation=function(){return this._armature.animation},n.getBone=function(t){return this._armature.getBone(t)},n.getPlayName=function(){return this._playName},n.getBoneDisplay=function(t){return t.slot.getDisplay()},n.changeBone=function(t,e){var i=this.getBone(t);i&&(i instanceof dragonBones.Bone?i.slot.display=e:i.slot.setDisplay(e))},e}(egret.DisplayObjectContainer);egret.registerClass(DragonBonesArmature,"DragonBonesArmature");var DragonBonesArmatureContainer=function(t){function e(){t.call(this),this.armatures=new Array,this.actions={},this.cacheBones={}}__extends(e,t);var i=__define,n=e,s=n.prototype;return s.register=function(t,e){this.armatures.push(t);for(var i=0,n=e.length;n>i;i++)this.actions[e[i]]=this.armatures.length-1},i(s,"armature",function(){return this.armatures[this.currArmatureIndex]}),s.getCacheBone=function(t){if(!this.cacheBones[t]){this.cacheBones[t]=[];for(var e=0,i=this.armatures.length;i>e;e++){var n=this.armatures[e];this.cacheBones[t].push(n.getBone(t))}}return this.cacheBones[t][this.currArmatureIndex]},s.play=function(t,e){if(void 0===e&&(e=void 0),null==this.actions[t])return void Log.trace("DragonBonesArmatureContainer不存在动作：",t);var i=this.actions[t];i!=this.currArmatureIndex&&this.remove();var n=this.armatures[i];return n?(this.addChild(n),this.currArmatureIndex=i,n.play(t,e)):null},s.stop=function(){var t=this.armatures[this.currArmatureIndex];t&&t.stop()},s.start=function(){var t=this.armatures[this.currArmatureIndex];t&&t.start()},s.remove=function(){var t=this.armatures[this.currArmatureIndex];t&&(t.stop(),App.DisplayUtils.removeFromParent(t),this.currArmatureIndex=null)},s.addCompleteCallFunc=function(t,e){for(var i=0,n=this.armatures.length;n>i;i++){var s=this.armatures[i];s.addCompleteCallFunc(t,e)}},s.removeCompleteCallFunc=function(t,e){for(var i=0,n=this.armatures.length;n>i;i++){var s=this.armatures[i];s.removeCompleteCallFunc(t,e)}},s.addFrameCallFunc=function(t,e){for(var i=0,n=this.armatures.length;n>i;i++){var s=this.armatures[i];s.addFrameCallFunc(t,e)}},s.removeFrameCallFunc=function(t,e){for(var i=0,n=this.armatures.length;n>i;i++){var s=this.armatures[i];s.removeFrameCallFunc(t,e)}},s.clear=function(){for(;this.armatures.length;){var t=this.armatures.pop();App.DisplayUtils.removeFromParent(t),t.destroy()}this.cacheBones={},this.actions={}},s.destroy=function(){this.clear(),this.armatures=null,this.cacheBones=null,this.actions=null},e}(egret.DisplayObjectContainer);egret.registerClass(DragonBonesArmatureContainer,"DragonBonesArmatureContainer");var DragonBonesFactory=function(t){function e(){t.call(this),this.averageUtils=new AverageUtils,this.factory=new dragonBones.EgretFactory,this.clocks=new Array,this.clocksLen=0,this.files=[],this.start()}__extends(e,t);var i=(__define,e),n=i.prototype;return n.initArmatureFile=function(t,e,i){-1==this.files.indexOf(t.name)&&(this.addSkeletonData(t),this.addTextureAtlas(e,i),this.files.push(t.name))},n.initArmatureMoreFile=function(t){this.factory.addSkeletonData(dragonBones.DataParser.parseDragonBonesData(t));for(var e=t.textureList,i=t.sheetList,n=new EgretTextureAtlasMore(RES.getRes(e[0]),RES.getRes(i[0]),t.name),s=e.length,r=1;s>r;r++)n.register(RES.getRes(e[r]),RES.getRes(i[r]));this.factory.addTextureAtlas(n)},n.removeArmatureFile=function(t){var e=this.files.indexOf(t);-1!=e&&(this.removeSkeletonData(t),this.removeTextureAtlas(t),this.files.splice(e,1))},n.clear=function(){for(;this.files.length;)this.removeArmatureFile(this.files[0])},n.addSkeletonData=function(t){this.factory.addSkeletonData(dragonBones.DataParser.parseDragonBonesData(t))},n.addTextureAtlas=function(t,e){this.factory.addTextureAtlas(new dragonBones.EgretTextureAtlas(t,e))},n.removeSkeletonData=function(t){this.factory.removeSkeletonData(t)},n.removeTextureAtlas=function(t){this.factory.removeTextureAtlas(t)},n.makeArmature=function(t,e,i){void 0===i&&(i=1);var n=this.factory.buildArmature(t,e);if(null==n)return Log.trace("不存在Armature： "+t),null;var s=this.createWorldClock(i),r=new DragonBonesArmature(n,s);return r},n.makeFastArmature=function(t,e,i){void 0===i&&(i=1);var n=this.factory.buildFastArmature(t,e);if(null==n)return Log.trace("不存在Armature： "+t),null;n.enableAnimationCache(30);var s=this.createWorldClock(i),r=new DragonBonesArmature(n,s);return r},n.createWorldClock=function(t){for(var e=0;e<this.clocksLen;e++)if(this.clocks[e].timeScale==t)return this.clocks[e];var i=new dragonBones.WorldClock;return i.timeScale=t,this.clocks.push(i),this.clocksLen=this.clocks.length,i},n.onEnterFrame=function(t){this.averageUtils.push(t);for(var e=.001*this.averageUtils.getValue(),i=0;i<this.clocksLen;i++){var n=this.clocks[i];n.advanceTime(e)}},n.stop=function(){this.isPlay&&(App.TimerManager.remove(this.onEnterFrame,this),this.isPlay=!1)},n.start=function(){this.isPlay||(this.isPlay=!0,App.TimerManager.doFrame(1,0,this.onEnterFrame,this))},e}(BaseClass);egret.registerClass(DragonBonesFactory,"DragonBonesFactory");var EgretTextureAtlasMore=function(t){function e(e,i,n,s){void 0===s&&(s=1),t.call(this,e,i,s),this._datas=[],this._textureIndex={},this.name=n,this.register(e,i)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.register=function(t,e){var i=this.parseSingleData(e);this.analysisSheet(i,this._datas.length),this._datas.push([new egret.SpriteSheet(t),i])},n.analysisSheet=function(t,e){for(var i=Object.keys(t),n=0,s=i.length;s>n;n++){var r=i[n];r&&""!=r&&this.addTextureDic(e,r)}},n.addTextureDic=function(t,e){this._textureIndex[e]=t},n.getTexture=function(t){var e=null,i=this._datas[this._textureIndex[t]];if(null==i)return null;var n=i[0],s=i[1][t];return s&&(e=n.getTexture(t),e||(e=n.createTexture(t,s.region.x,s.region.y,s.region.width,s.region.height))),e},n.dispose=function(){t.prototype.dispose.call(this),this._datas.length=0,this._datas=null,this._textureIndex=null},n.getRegion=function(t){for(var e=0,i=this._datas.length;i>e;e++){var n=this._datas[e],s=(n[0],n[1][t]);if(s)return s.region}return null},n.getFrame=function(t){for(var e=0,i=this._datas.length;i>e;e++){var n=this._datas[e],s=(n[0],n[1][t]);if(s)return s.frame}return null},n.parseSingleData=function(t){return dragonBones.DataParser.parseTextureAtlasData(t,this.scale)},e}(dragonBones.EgretTextureAtlas);egret.registerClass(EgretTextureAtlasMore,"EgretTextureAtlasMore");var GuideMaskBackgroud=function(t){function e(){t.call(this),this._stageWidth=0,this._stageHeight=0,this._bgs=new Array,this.touchEnabled=!0}__extends(e,t);var i=(__define,e),n=i.prototype;return n.init=function(t,e){this._stageWidth=t,this._stageHeight=e},n.draw=function(t){this.cacheAsBitmap=!1,this._deductRec=t,this.removeAllChild();var e=Math.max(t.x,0),i=Math.max(t.y,0),n=Math.min(t.x+t.width,this._stageWidth),s=Math.min(t.y+t.height,this._stageHeight);this.addBg(0,0,this._stageWidth,i),this.addBg(0,i,e,t.height),this.addBg(n,i,this._stageWidth-n,t.height),this.addBg(0,s,this._stageWidth,this._stageHeight-s),this.width=this._stageWidth,this.height=this._stageHeight,this.cacheAsBitmap=!0},n.destroy=function(){this.removeChildren(),this._bgs=[]},n.removeAllChild=function(){for(;this.numChildren;){var t=this.removeChildAt(0);this._bgs.push(t)}},n.addBg=function(t,e,i,n){var s;this._bgs.length?(s=this._bgs.pop(),s.graphics.clear()):s=new egret.Shape,s.graphics.beginFill(0,.5),s.graphics.drawRect(t,e,i,n),s.graphics.endFill(),this.addChild(s)},n.hitTest=function(t,e,i){return this._deductRec&&this._deductRec.contains(t,e)?null:this},e}(egret.Sprite);egret.registerClass(GuideMaskBackgroud,"GuideMaskBackgroud");var GuideUtils=function(t){function e(){t.apply(this,arguments),this.configData={1:{1:{txt:"点击这里，去设置宠物出战",txtdir:1,handDir:1},2:{txt:"点击选择一个宠物出战",txtdir:3,handDir:1},3:{txt:"点击宠物出战",txtdir:3,handDir:1}},2:{1:{txt:"更多宠物，可以抽取获得哦！",txtdir:1,handDir:2},2:{txt:"点击抽取宠物",txtdir:1,handDir:1}},3:{1:{txt:"点击选择另一个宠物",txtdir:1,handDir:1},2:{txt:"点击宠物出战",txtdir:3,handDir:1}},4:{1:{txt:"点击查看宠物属性",txtdir:4,handDir:1},2:{txt:"点击宠物升级",txtdir:1,handDir:2},3:{txt:"点击选择升级材料",txtdir:3,handDir:1},4:{txt:"选择一个宠物或卡牌作为材料",txtdir:3,handDir:1},5:{txt:"选择材料后点击确定回到升级界面",txtdir:1,handDir:2},6:{txt:"点击完成升级",txtdir:1,handDir:2}},5:{1:{txt:"现在立刻享受\n炫酷的飞行吧",txtdir:1,handDir:2},2:{txt:"每天前3次购买免费",txtdir:1,handDir:1},3:{txt:"开始战斗吧",txtdir:1,handDir:2}},6:{1:{txt:"点击这里查看战机",txtdir:1,handDir:1},2:{txt:"点击升级战机，\n可以提高战力",txtdir:1,handDir:2}}},this.currPart=0,this.currStep=0}__extends(e,t);var i=(__define,e),n=i.prototype;return n.next=function(){null!=this.view&&null!=this.view.parent&&(this.currStep++,this.configData[this.currPart][this.currStep]||(this.currPart++,this.currStep=1),this.configData[this.currPart]||(this.currPart=0,this.currStep=0),this.hide())},n.show=function(t,e,i){this.currPart==e&&this.currStep==i&&(null==this.view&&(this.view=new GuideView),this.view.setData(t,this.configData[this.currPart][this.currStep]),egret.MainContext.instance.stage.addChild(this.view))},n.hide=function(){App.DisplayUtils.removeFromParent(this.view)},n.isShow=function(){return null!=this.view&&null!=this.view.parent},e}(BaseClass);egret.registerClass(GuideUtils,"GuideUtils");var GuideView=function(t){function e(){t.call(this),this._objRec=new egret.Rectangle,this._objGlobalPoint=new egret.Point,this._bg=new GuideMaskBackgroud,this.addChild(this._bg),this._maskPic=StarlingSwfUtils.createS9Image("s9_guide_mask"),this.addChild(this._maskPic),this._textBgPic=StarlingSwfUtils.createS9Image("s9_guide_txt"),AnchorUtil.setAnchorY(this._textBgPic,1),this.addChild(this._textBgPic),this._handPic=StarlingSwfUtils.createImage("img_hand"),AnchorUtil.setAnchorX(this._handPic,.5),this.addChild(this._handPic),this._txt=new egret.TextField,this._txt.size=26,this._txt.textColor=5723991,this._txt.lineSpacing=4,AnchorUtil.setAnchorY(this._txt,.5),this.addChild(this._txt),egret.MainContext.instance.stage.addEventListener(egret.Event.RESIZE,this.onResize,this)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.onResize=function(){this.stage&&egret.setTimeout(this.refurbish,this,500)},n.refurbish=function(){this.setData(this._obj,this._data)},n.setData=function(t,e){if(null!=t){this._obj=t,this._data=e,this._obj.localToGlobal(0,0,this._objGlobalPoint),this._obj.getBounds(this._objRec),this._objGlobalPoint.x=Math.ceil(this._objGlobalPoint.x),this._objGlobalPoint.y=Math.ceil(this._objGlobalPoint.y);var i=15,n=15;this._objRec.x=this._objGlobalPoint.x-i,this._objRec.y=this._objGlobalPoint.y-n,this._objRec.width+=2*i,this._objRec.height+=2*n,this._bg.init(egret.MainContext.instance.stage.stageWidth,egret.MainContext.instance.stage.stageHeight),this._bg.draw(this._objRec),this._maskPic.cacheAsBitmap=!1,this._maskPic.x=this._objRec.x,this._maskPic.y=this._objRec.y,this._maskPic.width=this._objRec.width,this._maskPic.height=this._objRec.height,this._maskPic.cacheAsBitmap=!0,1==this._data.handDir?(this._handPic.scaleY=1,this._handPic.y=this._objRec.y+this._objRec.height-20):2==this._data.handDir&&(this._handPic.scaleY=-1,this._handPic.y=this._objRec.y+20),this._handPic.x=this._objRec.x+.5*this._objRec.width,this._txt.width=0/0,this._txt.height=0/0,this._txt.text=this._data.txt,this._txt.width>320&&(this._txt.text="",this._txt.width=320,this._txt.text=this._data.txt);var s=15;this._textBgPic.cacheAsBitmap=!1,this._textBgPic.width=this._txt.width+2*s+35,this._textBgPic.height=114,1==this._data.txtdir?(this._textBgPic.scaleX=-1,this._textBgPic.scaleY=1,this._textBgPic.x=this._objRec.x):2==this._data.txtdir?(this._textBgPic.scaleX=-1,this._textBgPic.scaleY=-1,this._textBgPic.x=this._objRec.x):3==this._data.txtdir?(this._textBgPic.scaleX=1,this._textBgPic.scaleY=1,this._textBgPic.x=this._objRec.x+this._objRec.width):4==this._data.txtdir&&(this._textBgPic.scaleX=1,this._textBgPic.scaleY=-1,this._textBgPic.x=this._objRec.x+this._objRec.width),this.checkTextBgX(),this._textBgPic.y=this._objRec.y+.5*this._objRec.height,this._txt.x=this._textBgPic.x-(-1==this._textBgPic.scaleX?this._textBgPic.width:-35)+s,this._txt.y=this._textBgPic.y-this._textBgPic.scaleY*this._textBgPic.height*.5,this._textBgPic.cacheAsBitmap=!0}},n.checkTextBgX=function(){if(1==this._textBgPic.scaleX){var t=egret.MainContext.instance.stage.stageWidth;this._textBgPic.x+this._textBgPic.width>t&&(this._textBgPic.x=t-this._textBgPic.width)}else-1==this._textBgPic.scaleX&&this._textBgPic.x-this._textBgPic.width<0&&(this._textBgPic.x=this._textBgPic.width)},e}(egret.Sprite);egret.registerClass(GuideView,"GuideView");var EasyLoading=function(t){function e(){t.call(this),this.content=null,this.speed=.6,this.init()}__extends(e,t);var i=(__define,e),n=i.prototype;return n.init=function(){this.averageUtils=new AverageUtils,this.content=new egret.Sprite,this.content.graphics.beginFill(0,.2),this.content.graphics.drawRect(0,0,App.StageUtils.getWidth(),App.StageUtils.getHeight()),this.content.graphics.endFill(),this.content.touchEnabled=!0,this.uiImageContainer=new egret.DisplayObjectContainer,this.uiImageContainer.x=.5*this.content.width,this.uiImageContainer.y=.5*this.content.height,this.content.addChild(this.uiImageContainer),RES.getResByUrl("resource/assets/load_Reel.png",function(t){var e=new egret.Bitmap;e.texture=t,e.x=.5*-e.width,e.y=.5*-e.height,this.uiImageContainer.addChild(e)},this,RES.ResourceItem.TYPE_IMAGE)},n.showLoading=function(){App.StageUtils.getStage().addChild(this.content),App.TimerManager.doFrame(1,0,this.enterFrame,this)},n.hideLoading=function(){this.content&&this.content.parent&&(App.StageUtils.getStage().removeChild(this.content),this.uiImageContainer.rotation=0),App.TimerManager.remove(this.enterFrame,this)},n.enterFrame=function(t){this.averageUtils.push(this.speed*t),this.uiImageContainer.rotation+=this.averageUtils.getValue()},e}(BaseClass);egret.registerClass(EasyLoading,"EasyLoading");var ControllerManager=function(t){function e(){t.call(this),this._modules={}}__extends(e,t);var i=(__define,e),n=i.prototype;return n.clear=function(){this._modules={}},n.register=function(t,e){this.isExists(t)||(this._modules[t]=e)},n.unregister=function(t){this.isExists(t)&&(this._modules[t]=null,delete this._modules[t])},n.isExists=function(t){return null!=this._modules[t]},n.applyFunc=function(t,e){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];var s=this._modules[t];if(s){for(var r=[],a=1;a<arguments.length;a++)r[a-1]=arguments[a];return s.applyFunc.apply(s,r)}return Log.trace("模块"+t+"不存在"),null},n.getControllerModel=function(t){var e=this._modules[t];return e?e.getModel():null},e}(BaseClass);egret.registerClass(ControllerManager,"ControllerManager");var ViewManager=function(t){function e(){t.call(this),this._views={},this._opens=[]}__extends(e,t);var i=(__define,e),n=i.prototype;return n.clear=function(){this.closeAll(),this._views={}},n.register=function(t,e){null!=e&&(this._views[t]||(this._views[t]=e))},n.unregister=function(t){this._views[t]&&(this._views[t]=null,delete this._views[t])},n.destroy=function(t,e){void 0===e&&(e=null);var i=this.getView(t);i&&(this.unregister(t),i.destroy(),i=null),this.register(t,e)},n.open=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var n=this.getView(t);return null==n?void Log.trace("UI_"+t+"不存在"):n.isShow()?(n.open.apply(n,e),n):(n.isInit()?(n.addToParent(),n.open.apply(n,e)):(App.EasyLoading.showLoading(),n.loadResource(function(){n.addToParent(),n.setVisible(!1)}.bind(this),function(){n.initUI(),n.initData(),n.open.apply(n,e),n.setVisible(!0),App.EasyLoading.hideLoading()}.bind(this))),this._opens.push(t),n)},n.close=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(this.isShow(t)){var n=this.getView(t);if(null!=n){var s=this._opens.indexOf(t);t>=0&&this._opens.splice(s,1),n.removeFromParent(),n.close.apply(n,e)}}},n.closeView=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];for(var n=Object.keys(this._views),s=0,r=n.length;r>s;s++){var a=parseInt(n[s]);if(this._views[a]==t)return void this.close(a,e)}},n.getView=function(t){return this._views[t]},n.closeAll=function(){for(;this._opens.length;)this.close(this._opens[0])},n.currOpenNum=function(){return this._opens.length},n.isShow=function(t){return-1!=this._opens.indexOf(t)},e}(BaseClass);egret.registerClass(ViewManager,"ViewManager");var BaseController=function(){function t(){this._messages={}}var e=(__define,t),i=e.prototype;return i.registerFunc=function(t,e,i){this._messages[t]=[e,i]},i.applyFunc=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var n=this._messages[t];return n?n[0].apply(n[1],e):(Log.trace("消息"+t+"不存在侦听"),null)},i.applyControllerFunc=function(t,e){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];return App.ControllerManager.applyFunc.apply(App.ControllerManager,arguments)},i.setModel=function(t){this._model=t},i.getModel=function(){return this._model},i.getControllerModel=function(t){return App.ControllerManager.getControllerModel(t)},t}();egret.registerClass(BaseController,"BaseController");var BaseModel=function(){function t(t){this._controller=t,this._controller.setModel(this)}var e=(__define,t);e.prototype;return t}();egret.registerClass(BaseModel,"BaseModel");var BaseProxy=function(){function t(t){this._controller=t}var e=(__define,t),i=e.prototype;return i.applyFunc=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];return this._controller.applyFunc.apply(this._controller,arguments)},i.applyControllerFunc=function(t,e){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];return this._controller.applyControllerFunc.apply(this._controller,arguments)},i.receiveServerMsg=function(t,e,i){App.MessageCenter.addListener(t,e,i)},i.receiveServerMsgOnce=function(t,e,i){var n=function(s){this.removeServerMsg(t,n,this),e.apply(i,s)};this.receiveServerMsg(t,n,this)},i.receiveServerHttpUpdateMsg=function(t,e,i){this.receiveServerMsg(t+"_HttpUpdate",e,i)},i.receiveServerHttpUpdateMsgOnce=function(t,e,i){this.receiveServerMsgOnce(t+"_HttpUpdate",e,i)},i.removeServerMsg=function(t,e,i){App.MessageCenter.removeListener(t,e,i)},i.removeServerHttpUpdateMsg=function(t,e,i){this.removeServerMsg(t+"_HttpUpdate",e,i)},i.sendSocketMsg=function(t){App.Socket.send(t)},i.sendHttpMsg=function(t,e){void 0===e&&(e=null),App.Http.send(t,this.getURLVariables(t,e))},i.getURLVariables=function(t,e){var i=t.split("."),n={};n.mod=i[0],n["do"]=i[1],null!=e&&(n.p=e);var s=JSON.stringify(n),r=new egret.URLVariables("data="+s+"&h="+App.ProxyUserFlag);return r},t}();egret.registerClass(BaseProxy,"BaseProxy");var BaseEuiView=function(t){function e(e,i){t.call(this),this._resources=null,this._controller=e,this._myParent=i,this._isInit=!1,this.percentHeight=100,this.percentWidth=100}__extends(e,t);var i=__define,n=e,s=n.prototype;return i(s,"myParent",function(){return this._myParent}),s.setResources=function(t){this._resources=t},s.isInit=function(){return this._isInit},s.applyFunc=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];return this._controller.applyFunc.apply(this._controller,arguments)},s.applyControllerFunc=function(t,e){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];return this._controller.applyControllerFunc.apply(this._controller,arguments)},s.isShow=function(){return null!=this.stage&&this.visible},s.addToParent=function(){this._myParent.addChild(this)},s.removeFromParent=function(){App.DisplayUtils.removeFromParent(this)},s.initUI=function(){this._isInit=!0},s.initData=function(){},s.destroy=function(){this._controller=null,this._myParent=null,this._resources=null},s.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e]},s.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e]},s.loadResource=function(t,e){this._resources&&this._resources.length>0?(App.ResourceUtils.loadResource(this._resources,[],t,null,this),this.addEventListener(eui.UIEvent.CREATION_COMPLETE,e,this)):(t(),e())
},s.setVisible=function(t){this.visible=t},e}(eui.Component);egret.registerClass(BaseEuiView,"BaseEuiView",["IBaseView"]);var BaseSpriteView=function(t){function e(e,i){t.call(this),this._resources=null,this._controller=e,this._myParent=i,this._isInit=!1,App.StageUtils.getStage().addEventListener(egret.Event.RESIZE,this.onResize,this)}__extends(e,t);var i=__define,n=e,s=n.prototype;return s.setResources=function(t){this._resources=t},i(s,"myParent",function(){return this._myParent}),s.isInit=function(){return this._isInit},s.applyFunc=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];return this._controller.applyFunc.apply(this._controller,arguments)},s.applyControllerFunc=function(t,e){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];return this._controller.applyControllerFunc.apply(this._controller,arguments)},s.isShow=function(){return null!=this.stage&&this.visible},s.addToParent=function(){this._myParent.addChild(this)},s.removeFromParent=function(){App.DisplayUtils.removeFromParent(this)},s.initUI=function(){this._isInit=!0},s.initData=function(){},s.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e]},s.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e]},s.destroy=function(){this._controller=null,this._myParent=null,this._resources=null},s.onResize=function(){},s.loadResource=function(t,e){this._resources&&this._resources.length>0?App.ResourceUtils.loadResource(this._resources,[],function(){t(),e()},null,this):(t(),e())},s.setVisible=function(t){this.visible=t},e}(egret.DisplayObjectContainer);egret.registerClass(BaseSpriteView,"BaseSpriteView",["IBaseView"]);var DynamicChange=function(){function t(){this._dataCache=[],this._pUpdate=new ProxyUpdate(this._dataCache)}var e=__define,i=t,n=i.prototype;return e(n,"pUpdate",function(){return this._pUpdate}),n.getCacheData=function(t){return this._dataCache[t]?this._dataCache[t]:null},n.clearCache=function(){for(var t=Object.keys(this._dataCache),e=0,i=t.length;i>e;e++){var n=t[e];this._dataCache[n]=null,delete this._dataCache[n]}},n.getCacheKeyInfos=function(){for(var t=[],e=Object.keys(this._dataCache),i=0,n=e.length;n>i;i++){var s=e[i],r=this._dataCache[s];t.push(r)}return t},n.isCache=function(t){return this._dataCache[t]},t}();egret.registerClass(DynamicChange,"DynamicChange");var ProxyUpdate=function(){function t(t){this._cache=t}var e=(__define,t),i=e.prototype;return i.isArray=function(t){return t instanceof Array},i.isObject=function(t){return t.indexOf("object")>-1},i.isNormal=function(t){var e=t.indexOf("@")>-1,i=t.indexOf(".")>-1,n=t.indexOf("_")>-1;return!e&&!i&&!n},i.isAddToArray=function(t){return"@a"==t},i.isRemoveToArray=function(t){var e=t.split("_");return e.length<=3&&"@d"==e[0]},i.isFilter=function(t){var e=t.split("_");return"@f"==e[0]},i.isNumeric=function(t){return parseFloat(t).toString()==t.toString()},i._updateObject=function(t,e,i){var n=t.split(".");"@a"==n[0]||"@s"==n[0]?i[n[1]]=e:"@d"==n[0]&&delete i[n[1]]},i._getFilterObject=function(t,e){if(e){var i=t.split("_");if(3==i.length&&"@f"==i[0]&&this.isArray(e))for(var n=i[1],s=i[2],r=0;r<e.length;r++){var a=e[r];if(3==i.length&&this.isObject(a.toString())){var o=a[n];if(o&&("@"==s[0]&&(s=s.replace("@","")),s==o))return a}}}return null},i._addObjectToArray=function(t,e){if(this.isArray(e))for(var i=0;i<e.length;i++)t.push(e[i]);else t.push(e)},i._removeObjectFromArray=function(t,e,i){var n=e.split("_");if(n.length<=3&&"@d"==n[0]&&this.isArray(t))for(var s=t.length,r=s-1;r>=0;r--){var a=t[r];if(3==n.length){if(a.hasOwnProperty(n[1])){var o=n[2];"@"==o[0]&&(o=o.replace("@","")),o==a[n[1]]&&t.splice(r,1)}}else 2==n.length&&a.hasOwnProperty(n[1])?i==a[n[1]]&&t.splice(r,1):1==n.length&&i==a&&t.splice(r,1)}},i.update=function(t,e){if(this._cache[t]=e,e.hasOwnProperty("c"))for(var i=e.c,n=Object.keys(i),s=0,r=n.length;r>s;s++){var a=n[s];this._cache[a]&&(this._update(this._cache[a],i[a]),App.MessageCenter.dispatch(a+"_HttpUpdate"))}},i._update=function(t,e){if(t&&e&&this.isObject(e.toString()))for(var i=Object.keys(e),n=0,s=i.length;s>n;n++){var r=i[n],a=e[r];if(this.isNormal(r)&&this.isObject(a.toString()))t.hasOwnProperty(r)&&this._update(t[r],a);else if(this.isNormal(r)&&this.isNumeric(a)){var o=t[r];t[r]=o+a}else if(this.isNormal(r))t[r]=a;else if(this.isAddToArray(r))this._addObjectToArray(t,a);else if(this.isRemoveToArray(r))this._removeObjectFromArray(t,r,a);else if(this.isFilter(r)){var h=this._getFilterObject(r,t);h&&this._update(h,a)}else this._updateObject(r,a,t)}},t}();egret.registerClass(ProxyUpdate,"ProxyUpdate");var Http=function(t){function e(){t.call(this),this._data=new DynamicChange,this._cache=[],this._request=new egret.URLRequest,this._request.method=egret.URLRequestMethod.POST,this._urlLoader=new egret.URLLoader,this._urlLoader.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onError,this)}__extends(e,t);var i=__define,n=e,s=n.prototype;return s.initServer=function(t){this._serverUrl=t},i(s,"Data",function(){return this._data}),s.onError=function(t){this.nextPost()},s.send=function(t,e){this._cache.push([t,e]),this.post()},s.post=function(){if(!this._isRequesting&&0!=this._cache.length){var t=this._cache.shift(),e=t[0],i=t[1];this._type=e,this._request.url=this._serverUrl,this._request.data=i,this._urlLoader.addEventListener(egret.Event.COMPLETE,this.onLoaderComplete,this),this._urlLoader.load(this._request),this._isRequesting=!0}},s.onLoaderComplete=function(t){this._urlLoader.removeEventListener(egret.Event.COMPLETE,this.onLoaderComplete,this);var e=JSON.parse(this._urlLoader.data);e.hasOwnProperty("s")&&0!=e.s?Log.trace("Http错误:"+e.s):(this._data.pUpdate.update(this._type,e),App.MessageCenter.dispatch(this._type,e)),this.nextPost()},s.nextPost=function(){this._isRequesting=!1,this.post()},e}(BaseClass);egret.registerClass(Http,"Http");var ByteArrayMsg=function(){function t(){this._msgBuffer=new egret.ByteArray}var e=(__define,t),i=e.prototype;return i.receive=function(t){t.readBytes(this._msgBuffer);var e=this.decode(this._msgBuffer);e&&App.MessageCenter.dispatch(e.key,e.body),0==this._msgBuffer.bytesAvailable&&this._msgBuffer.clear()},i.send=function(t,e){var i=this.encode(e);i&&(i.position=0,t.writeBytes(i,0,i.bytesAvailable))},i.decode=function(t){return Log.trace("decode需要子类重写，根据项目的协议结构解析"),null},i.encode=function(t){return Log.trace("encode需要子类重写，根据项目的协议结构解析"),null},t}();egret.registerClass(ByteArrayMsg,"ByteArrayMsg",["BaseMsg"]);var ByteArrayMsgByProtobuf=function(t){function e(){t.call(this),this.msgClass=null,this.protoConfig=null,this.protoConfigSymmetry=null,this.msgClass={},this.protoConfig=App.ProtoConfig,this.protoConfigSymmetry={};for(var e=Object.keys(this.protoConfig),i=0,n=e.length;n>i;i++){var s=e[i],r=this.protoConfig[s];this.protoConfigSymmetry[r]=s}}__extends(e,t);var i=(__define,e),n=i.prototype;return n.getMsgClass=function(t){var e=this.msgClass[t];return null==e&&(e=App.ProtoFile.build(t),this.msgClass[t]=e),e},n.getMsgID=function(t){return this.protoConfigSymmetry[t]},n.getMsgKey=function(t){return this.protoConfig[t]},n.decode=function(t){var e=t.readShort(),i=t.readShort();if(t.bytesAvailable>=i){var n=new egret.ByteArray;t.readBytes(n,0,i);var s={};return s.key=this.getMsgKey(e),App.DebugUtils.start("Protobuf Decode"),s.body=this.getMsgClass(s.key).decode(n.buffer),App.DebugUtils.stop("Protobuf Decode"),Log.trace("收到数据：","["+e+" "+s.key+"]",s.body),s}return null},n.encode=function(t){var e=this.getMsgID(t.key),i=new(this.getMsgClass(t.key))(t.body);App.DebugUtils.start("Protobuf Encode");var n=new egret.ByteArray(i.toArrayBuffer());App.DebugUtils.stop("Protobuf Encode"),Log.trace("发送数据：","["+e+" "+t.key+"]",t.body);var s=new egret.ByteArray;return s.writeShort(e),s.writeBytes(n),s},e}(ByteArrayMsg);egret.registerClass(ByteArrayMsgByProtobuf,"ByteArrayMsgByProtobuf");var Socket=function(t){function e(){t.call(this),this._needReconnect=!1,this._maxReconnectCount=10,this._reconnectCount=0}__extends(e,t);var i=(__define,e),n=i.prototype;return n.addEvents=function(){this._socket.addEventListener(egret.ProgressEvent.SOCKET_DATA,this.onReceiveMessage,this),this._socket.addEventListener(egret.Event.CONNECT,this.onSocketOpen,this),this._socket.addEventListener(egret.Event.CLOSE,this.onSocketClose,this),this._socket.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onSocketError,this)},n.removeEvents=function(){this._socket.removeEventListener(egret.ProgressEvent.SOCKET_DATA,this.onReceiveMessage,this),this._socket.removeEventListener(egret.Event.CONNECT,this.onSocketOpen,this),this._socket.removeEventListener(egret.Event.CLOSE,this.onSocketClose,this),this._socket.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.onSocketError,this)},n.onSocketOpen=function(){this._reconnectCount=0,this._connectFlag?App.MessageCenter.dispatch(SocketConst.SOCKET_RECONNECT):App.MessageCenter.dispatch(SocketConst.SOCKET_CONNECT),this._connectFlag=!0,this._isConnecting=!0},n.onSocketClose=function(){this._needReconnect?(this.reconnect(),App.MessageCenter.dispatch(SocketConst.SOCKET_START_RECONNECT)):App.MessageCenter.dispatch(SocketConst.SOCKET_CLOSE),this._isConnecting=!1},n.onSocketError=function(){this._needReconnect?this.reconnect():App.MessageCenter.dispatch(SocketConst.SOCKET_NOCONNECT),this._isConnecting=!1},n.onReceiveMessage=function(t){this._msg.receive(this._socket)},n.initServer=function(t,e,i){this._host=t,this._port=e,this._msg=i},n.connect=function(){return App.DeviceUtils.IsHtml5&&!window.WebSocket?void Log.trace("不支持WebSocket"):(this._socket=new egret.WebSocket,this._msg instanceof ByteArrayMsg&&(this._socket.type=egret.WebSocket.TYPE_BINARY),Log.trace("WebSocket: "+this._host+":"+this._port),this._socket.connect(this._host,this._port),void this.addEvents())},n.reconnect=function(){this.close(),this._reconnectCount++,this._reconnectCount<this._maxReconnectCount?this.connect():(this._reconnectCount=0,this._connectFlag?App.MessageCenter.dispatch(SocketConst.SOCKET_CLOSE):App.MessageCenter.dispatch(SocketConst.SOCKET_NOCONNECT))},n.send=function(t){this._msg.send(this._socket,t)},n.close=function(){this.removeEvents(),this._socket.close(),this._socket=null,this._isConnecting=!1,this._connectFlag=!1},n.isConnecting=function(){return this._isConnecting},n.debugInfo=function(t){App.MessageCenter.dispatch(SocketConst.SOCKET_DEBUG_INFO,t)},e}(BaseClass);egret.registerClass(Socket,"Socket");var SocketConst=function(){function t(){}var e=(__define,t);e.prototype;return t.SOCKET_CONNECT="SOCKET_CONNECT",t.SOCKET_RECONNECT="SOCKET_RECONNECT",t.SOCKET_START_RECONNECT="SOCKET_START_RECONNECT",t.SOCKET_CLOSE="SOCKET_CLOSE",t.SOCKET_DATA="SOCKET_DATA",t.SOCKET_NOCONNECT="SOCKET_NOCONNECT",t.SOCKET_DEBUG_INFO="SOCKET_DEBUG_INFO",t}();egret.registerClass(SocketConst,"SocketConst");var UTFMsg=function(){function t(){}var e=(__define,t),i=e.prototype;return i.receive=function(t){var e=t.readUTF(),i=this.decode(e);i&&App.MessageCenter.dispatch(i.key,i.body)},i.send=function(t,e){var i=this.encode(e);i&&(t.type=egret.WebSocket.TYPE_STRING,t.writeUTF(i))},i.decode=function(t){return Log.trace("decode需要子类重写，根据项目的协议结构解析"),null},i.encode=function(t){return Log.trace("encode需要子类重写，根据项目的协议结构解析"),null},t}();egret.registerClass(UTFMsg,"UTFMsg",["BaseMsg"]);var UTFMsgByJson=function(t){function e(){t.call(this)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.decode=function(t){return JSON.parse(t)},n.encode=function(t){return JSON.stringify(t)},e}(UTFMsg);egret.registerClass(UTFMsgByJson,"UTFMsgByJson");var BaseEuiLayer=function(t){function e(){t.call(this),this.percentWidth=100,this.percentHeight=100,this.touchEnabled=!1}__extends(e,t);var i=(__define,e);i.prototype;return e}(eui.Group);egret.registerClass(BaseEuiLayer,"BaseEuiLayer");var BaseScene=function(){function t(){this._layers=new Array}var e=(__define,t),i=e.prototype;return i.onEnter=function(){},i.onExit=function(){App.ViewManager.closeAll(),this.removeAllLayer()},i.addLayer=function(t){t instanceof BaseSpriteLayer?(App.StageUtils.getStage().addChild(t),this._layers.push(t)):t instanceof BaseEuiLayer&&(App.StageUtils.getUIStage().addChild(t),this._layers.push(t))},i.addLayerAt=function(t,e){t instanceof BaseSpriteLayer?(App.StageUtils.getStage().addChildAt(t,e),this._layers.push(t)):t instanceof BaseEuiLayer&&(App.StageUtils.getUIStage().addChildAt(t,e),this._layers.push(t))},i.removeLayer=function(t){t instanceof BaseSpriteLayer?(App.StageUtils.getStage().removeChild(t),this._layers.splice(this._layers.indexOf(t),1)):t instanceof BaseEuiLayer&&(App.StageUtils.getUIStage().removeChild(t),this._layers.splice(this._layers.indexOf(t),1))},i.layerRemoveAllChild=function(t){t instanceof BaseSpriteLayer?t.removeChildren():t instanceof BaseEuiLayer&&t.removeChildren()},i.removeAllLayer=function(){for(;this._layers.length;){var t=this._layers[0];this.layerRemoveAllChild(t),this.removeLayer(t)}},t}();egret.registerClass(BaseScene,"BaseScene");var BaseSpriteLayer=function(t){function e(){t.call(this),this.touchEnabled=!1}__extends(e,t);var i=(__define,e);i.prototype;return e}(egret.DisplayObjectContainer);egret.registerClass(BaseSpriteLayer,"BaseSpriteLayer");var SceneManager=function(t){function e(){t.call(this),this._scenes={}}__extends(e,t);var i=(__define,e),n=i.prototype;return n.clear=function(){var t=this._scenes[this._currScene];t&&(t.onExit(),this._currScene=void 0),this._scenes={}},n.register=function(t,e){this._scenes[t]=e},n.runScene=function(t){var e=this._scenes[t];if(null==e)return void Log.trace("场景"+t+"不存在");var i=this._scenes[this._currScene];i&&i.onExit(),e.onEnter(),this._currScene=t},n.getCurrScene=function(){return this._currScene},e}(BaseClass);egret.registerClass(SceneManager,"SceneManager");var BaseSound=function(){function t(){this._cache={},this._loadingCache=new Array,App.TimerManager.doTimer(6e4,0,this.dealSoundTimer,this)}var e=(__define,t),i=e.prototype;return i.dealSoundTimer=function(){for(var t=egret.getTimer(),e=Object.keys(this._cache),i=0,n=e.length;n>i;i++){var s=e[i];this.checkCanClear(s)&&t-this._cache[s]>=SoundManager.CLEAR_TIME&&(delete this._cache[s],RES.destroyRes(s))}},i.getSound=function(t){var e=RES.getRes(t);if(e)this._cache[t]&&(this._cache[t]=egret.getTimer());else{if(-1!=this._loadingCache.indexOf(t))return null;this._loadingCache.push(t),RES.getResAsync(t,this.onResourceLoadComplete,this)}return e},i.onResourceLoadComplete=function(t,e){var i=this._loadingCache.indexOf(e);-1!=i&&(this._loadingCache.splice(i,1),this._cache[e]=egret.getTimer(),this.loadedPlay(e))},i.loadedPlay=function(t){},i.checkCanClear=function(t){return!0},t}();egret.registerClass(BaseSound,"BaseSound");var SoundBg=function(t){function e(){t.call(this),this._currBg=""}__extends(e,t);var i=(__define,e),n=i.prototype;return n.stop=function(){this._currSoundChannel&&this._currSoundChannel.stop(),this._currSoundChannel=null,this._currSound=null,this._currBg=""},n.play=function(t){if(this._currBg!=t){this.stop(),this._currBg=t;var e=this.getSound(t);e&&this.playSound(e)}},n.playSound=function(t){this._currSound=t,this._currSoundChannel=this._currSound.play(0,1),this._currSoundChannel.volume=this._volume},n.setVolume=function(t){this._volume=t,this._currSoundChannel&&(this._currSoundChannel.volume=this._volume)},n.loadedPlay=function(t){this._currBg==t&&this.playSound(RES.getRes(t))},n.checkCanClear=function(t){return this._currBg!=t},e}(BaseSound);egret.registerClass(SoundBg,"SoundBg");var SoundEffects=function(t){function e(){t.call(this)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.play=function(t){var e=this.getSound(t);e&&this.playSound(e)},n.playSound=function(t){var e=t.play(0,1);e.volume=this._volume},n.setVolume=function(t){this._volume=t},n.loadedPlay=function(t){this.playSound(RES.getRes(t))},e}(BaseSound);egret.registerClass(SoundEffects,"SoundEffects");var SoundManager=function(t){function e(){t.call(this),this.bgOn=!0,this.effectOn=!0,this.bgVolume=.5,this.effectVolume=.5,this.bg=new SoundBg,this.bg.setVolume(this.bgVolume),this.effect=new SoundEffects,this.effect.setVolume(this.effectVolume)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.playEffect=function(t){this.effectOn&&this.effect.play(t)},n.playBg=function(t){this.currBg=t,this.bgOn&&this.bg.play(t)},n.stopBg=function(){this.bg.stop()},n.setEffectOn=function(t){this.effectOn=t},n.setBgOn=function(t){this.bgOn=t,this.bgOn?this.currBg&&this.playBg(this.currBg):this.stopBg()},n.setBgVolume=function(t){t=Math.min(t,1),t=Math.max(t,0),this.bgVolume=t,this.bg.setVolume(this.bgVolume)},n.getBgVolume=function(){return this.bgVolume},n.setEffectVolume=function(t){t=Math.min(t,1),t=Math.max(t,0),this.effectVolume=t,this.effect.setVolume(this.effectVolume)},n.getEffectVolume=function(){return this.effectVolume},e.CLEAR_TIME=18e4,e}(BaseClass);egret.registerClass(SoundManager,"SoundManager");var starlingswf;!function(t){var e=function(){function e(i,n,s){void 0===s&&(s=24),this._swfData=i,this._assetManager=n,this._createDisplayFuns=new Object,this._createDisplayFuns[e.dataKey_Sprite]=this.createSprite,this._createDisplayFuns[e.dataKey_MovieClip]=this.createMovie,this._createDisplayFuns[e.dataKey_Image]=this.createImage,this._createDisplayFuns[e.dataKey_Scale9]=this.createS9Image,this._createDisplayFuns[e.dataKey_ShapeImg]=this.createShapeImage,this._createDisplayFuns[e.dataKey_TextField]=this.createTextField,this.swfUpdateManager=t.SwfUpdateManager.createSwfUpdateManager(s)}var i=(__define,e),n=i.prototype;return n.createSprite=function(i,n,s){void 0===n&&(n=null),void 0===s&&(s=null),null==s&&(s=this._swfData[e.dataKey_Sprite][i]);for(var r,a,o,h=new t.SwfSprite,l=s.length,c=0;l>c;c++)r=s[c],o=this._createDisplayFuns[r[1]],null!=o&&(a=o.apply(this,[r[0],r]),a.name=r[9],a.x=r[2],a.y=r[3],r[0]==e.dataKey_TextField,r[1]!=e.dataKey_Scale9&&r[1]!=e.dataKey_ShapeImg&&(a.scaleX=r[4],a.scaleY=r[5]),a.skewX=r[6],a.skewY=r[7],a.alpha=r[8],h.addChild(a));return h},n.createMovie=function(i,n,s){void 0===n&&(n=null),void 0===s&&(s=null);var r,a,o,h,l,c=this._swfData[e.dataKey_MovieClip][i],u=c.objCount,g={};for(l in u){a=u[l][0],o=u[l][1],r=null==g[l]?[]:g[l];for(var d=0;o>d;d++)h=this._createDisplayFuns[a],null!=h&&r.push(h.apply(this,[l,null]));g[l]=r}var f;return f=null==s?new t.SwfMovieClip(c.frames,c.labels,g,this):new s(c.frames,c.labels,g,this),f.loop=c.loop,f},n.createImage=function(t,i){void 0===i&&(i=null);var n=this._swfData[e.dataKey_Image][t],s=this._assetManager.createBitmap(t);return s.anchorOffsetX=n[0],s.anchorOffsetY=n[1],s},n.getTexture=function(t){return this._assetManager.getTexture(t)},n.createS9Image=function(t,i){void 0===i&&(i=null);var n=this._swfData[e.dataKey_Scale9][t],s=this._assetManager.createBitmap(t);return s.scale9Grid=new egret.Rectangle(n[0],n[1],n[2],n[3]),null!=i&&(s.width=i[10],s.height=i[11]),s},n.createShapeImage=function(t,e){void 0===e&&(e=null);var i=this._assetManager.createBitmap(t);return i.fillMode=egret.BitmapFillMode.REPEAT,null!=e&&(i.width=e[10],i.height=e[11]),i},n.createTextField=function(t,e){void 0===e&&(e=null);var i=new egret.TextField;return null!=e&&(i.width=e[10],i.height=e[11],i.textColor=e[13],i.size=e[14],i.textAlign=e[15],i.text=e[18]),i},n.hasSprite=function(t){return null!=this._swfData[e.dataKey_Sprite][t]},n.hasMovieClip=function(t){return null!=this._swfData[e.dataKey_MovieClip][t]},n.hasImage=function(t){return null!=this._swfData[e.dataKey_Image][t]},n.hasS9Image=function(t){return null!=this._swfData[e.dataKey_Scale9][t]},n.hasShapeImage=function(t){return null!=this._swfData[e.dataKey_ShapeImg][t]},e.dataKey_Sprite="spr",e.dataKey_Image="img",e.dataKey_MovieClip="mc",e.dataKey_TextField="text",e.dataKey_Button="btn",e.dataKey_Scale9="s9",e.dataKey_ShapeImg="shapeImg",e.dataKey_Component="comp",e.dataKey_Particle="particle",e}();t.Swf=e,egret.registerClass(e,"starlingswf.Swf")}(starlingswf||(starlingswf={}));var starlingswf;!function(t){var e=function(){function t(){this._sheets={},this._textures={}}var e=(__define,t),i=e.prototype;return i.addSpriteSheet=function(t,e){this._sheets[t]=e},i.addTexture=function(t,e){this._textures[t]=e},i.createBitmap=function(t){var e=this.getTexture(t);if(null==e)return null;var i=new egret.Bitmap;return i.texture=e,i},i.getTexture=function(t){var e,i,n;for(n in this._sheets)if(i=this._sheets[n],e=i.getTexture(t),null!=e)break;return null==e&&(e=this._textures[t]),e},t}();t.SwfAssetManager=e,egret.registerClass(e,"starlingswf.SwfAssetManager")}(starlingswf||(starlingswf={}));var starlingswf;!function(t){var e=function(){function t(){}var e=(__define,t),i=e.prototype;return t.createSwfUpdateManager=function(e){var i=new t;return i._animations=[],i._addQueue=[],i._removeQueue=[],i._currentTime=0,i.setFps(e),App.TimerManager.doFrame(1,0,i.update,i),i},i.clear=function(){this._addQueue.splice(0),this._removeQueue.splice(0),this._animations.splice(0)},i.stop=function(){this.clear(),App.TimerManager.remove(this.update,this)},i.play=function(){App.TimerManager.doFrame(1,0,this.update,this)},i.setFps=function(t){this._fps=t,this._fpsTime=1e3/t},i.addSwfAnimation=function(t){this._addQueue.push(t)},i.removeSwfAnimation=function(t){this._removeQueue.push(t);var e=this._addQueue.indexOf(t);-1!=e&&this._addQueue.splice(e,1)},i.updateAdd=function(){for(var t,e,i=this._addQueue.length,n=0;i>n;n++)e=this._addQueue.pop(),t=this._animations.indexOf(e),-1==t&&this._animations.push(e)},i.updateRemove=function(){for(var t,e,i=this._removeQueue.length,n=0;i>n;n++)e=this._removeQueue.pop(),t=this._animations.indexOf(e),-1!=t&&this._animations.splice(t,1)},i.update=function(t){if(this._currentTime+=t,!(this._currentTime<this._fpsTime)){this._currentTime-=this._fpsTime,this._update();for(var e=0;this._currentTime>this._fpsTime;)this._currentTime-=this._fpsTime,e++,4>e&&this._update()}},i._update=function(){this.updateRemove(),this.updateAdd();for(var t=this._animations.length,e=0;t>e;e++)this._animations[e].update()},t}();t.SwfUpdateManager=e,egret.registerClass(e,"starlingswf.SwfUpdateManager")}(starlingswf||(starlingswf={}));var starlingswf;!function(t){var e=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.getTextField=function(t){return this.getChildByName(t)},n.getMovie=function(t){return this.getChildByName(t)},n.getSprite=function(t){return this.getChildByName(t)},n.getImage=function(t){return this.getChildByName(t)},e}(egret.DisplayObjectContainer);t.SwfSprite=e,egret.registerClass(e,"starlingswf.SwfSprite")}(starlingswf||(starlingswf={}));var starlingswf;!function(t){var e=function(e){function i(t,i,n,s){e.call(this),this._isPlay=!1,this.loop=!0,this._completeFunction=null,this._hasCompleteListener=!1,this._frames=t,this._labels=i,this._displayObjects=n,this._startFrame=0,this._endFrame=this._frames.length-1,this._ownerSwf=s,this.setCurrentFrame(0),this.play()}__extends(i,e);var n=(__define,i),s=n.prototype;return s.update=function(){if(this._isPlay)if(this._currentFrame>this._endFrame){if(this._hasCompleteListener&&this.dispatchEventWith(egret.Event.COMPLETE),this._currentFrame=this._startFrame,!this.loop)return void(this._ownerSwf&&this.stop(!1));if(this._startFrame==this._endFrame)return void(this._ownerSwf&&this.stop(!1));this.setCurrentFrame(this._startFrame)}else this.setCurrentFrame(this._currentFrame),this._currentFrame+=1},s.setCurrentFrame=function(e){this.$children.length=0,this._currentFrame=e,this.__frameInfos=this._frames[this._currentFrame];for(var i,n,s,r,a=this.__frameInfos.length,o=0;a>o;o++)i=this.__frameInfos[o],r=i[10],n=this._displayObjects[i[0]][r],n.skewX=i[6],n.skewY=i[7],n.alpha=i[8],n.name=i[9],n.x=i[2],n.y=i[3],i[1]==t.Swf.dataKey_Scale9?(n.width=i[11],n.height=i[12]):(n.scaleX=i[4],n.scaleY=i[5]),this.$children.push(n),n.$parent=this,i[1]==t.Swf.dataKey_TextField&&(s=n,s.width=i[11],s.height=i[12],s.textColor=i[14],s.size=i[15],s.textAlign=i[16],i[19]&&"\r"!=i[19]&&""!=i[19]&&(s.text=i[19]))},s.getCurrentFrame=function(){return this._currentFrame},s.play=function(){this._isPlay=!0,this._ownerSwf.swfUpdateManager.addSwfAnimation(this);var e,i,n;for(e in this._displayObjects)if(0==e.indexOf(t.Swf.dataKey_MovieClip)){i=this._displayObjects[e],n=i.length;for(var s=0;n>s;s++)i[s].play()}},s.stop=function(e){if(void 0===e&&(e=!0),this._isPlay=!1,this._ownerSwf.swfUpdateManager.removeSwfAnimation(this),e){var i,n,s;for(i in this._displayObjects)if(0==i.indexOf(t.Swf.dataKey_MovieClip)){n=this._displayObjects[i],s=n.length;for(var r=0;s>r;r++)n[r].stop(e)}}},s.gotoAndStop=function(t,e){void 0===e&&(e=!0),this.goTo(t),this.stop(e)},s.gotoAndPlay=function(t){this.goTo(t),this.play()},s.goTo=function(t){if("string"==typeof t){var e=this.getLabelData(t);this._currentLabel=e[0],this._currentFrame=this._startFrame=e[1],this._endFrame=e[2]}else"number"==typeof t&&(this._currentFrame=this._startFrame=t,this._endFrame=this._frames.length-1);this.setCurrentFrame(this._currentFrame)},s.getLabelData=function(t){for(var e,i=this._labels.length,n=0;i>n;n++)if(e=this._labels[n],e[0]==t)return e;return null},s.isPlay=function(){return this._isPlay},s.totalFrames=function(){return this._frames.length},s.currentLabel=function(){return this._currentLabel},s.labels=function(){for(var t=this._labels.length,e=[],i=0;t>i;i++)e.push(this._labels[i][0]);return e},s.hasLabel=function(t){var e=this.labels();return!(-1==e.indexOf(t))},s.addEventListener=function(t,i,n,s,r){void 0===s&&(s=!1),void 0===r&&(r=0),e.prototype.addEventListener.call(this,t,i,n,s,r),this._hasCompleteListener=this.hasEventListener(egret.Event.COMPLETE)},s.removeEventListener=function(t,i,n,s){void 0===s&&(s=!1),e.prototype.removeEventListener.call(this,t,i,n,s),this._hasCompleteListener=this.hasEventListener(egret.Event.COMPLETE)},s.getLabelStartFrame=function(t){return this.getLabelData(t)[1]},s.getLabelEndFrame=function(t){return this.getLabelData(t)[2]},i}(t.SwfSprite);t.SwfMovieClip=e,egret.registerClass(e,"starlingswf.SwfMovieClip",["starlingswf.ISwfAnimation"])}(starlingswf||(starlingswf={}));var StarlingSwfFactory=function(t){function e(){t.call(this),this.swfAssetsManager=new starlingswf.SwfAssetManager,this.swfAssetsNames=new Array,this.swfAssets=new Array,this.swfData={}}__extends(e,t);var i=(__define,e),n=i.prototype;return n.addSwf=function(t,e,i){if(-1==this.swfAssetsNames.indexOf(t)){if(null==e||null==i)return void console.log("SWF加载失败:"+t);this.swfAssetsManager.addSpriteSheet(t,i);var n=new starlingswf.Swf(e,this.swfAssetsManager,24);n.name=t,StarlingSwfUtils.addSwf(n),this.swfAssetsNames.push(t),this.swfAssets.push(n)}},n.stopSwfs=function(t){for(var e=0,i=t.length;i>e;e++){var n=StarlingSwfUtils.getSwf(t[e]);n&&n.swfUpdateManager.stop()}},n.playSwfs=function(t){for(var e=0,i=t.length;i>e;e++){var n=StarlingSwfUtils.getSwf(t[e]);n&&n.swfUpdateManager.play()}},n.clearSwfs=function(){for(;this.swfAssets.length;)StarlingSwfUtils.removeSwf(this.swfAssets.pop());for(;this.swfAssetsNames.length;)this.swfAssetsNames.pop();this.swfAssetsManager=new starlingswf.SwfAssetManager},n.clear=function(){this.clearSwfs()},n.makeMc=function(t){var e=StarlingSwfUtils.createMovie("mc_"+t,null,StarlingSwfMovieClip);return null==e&&console.log("SWF创建失败: "+t),e},n.makeImage=function(t){return StarlingSwfUtils.createImage("img_"+t)},n.getTexture=function(t){return StarlingSwfUtils.getTexture("img_"+t)},e}(BaseClass);egret.registerClass(StarlingSwfFactory,"StarlingSwfFactory");var StarlingSwfMovieClip=function(t){function e(e,i,n,s){t.call(this,e,i,n,s),this.frameActions={},this.preFrame=-1,this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemove,this)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.onRemove=function(){this.stop()},n.setFrameAction=function(t,e,i,n){void 0===n&&(n=null),this.frameActions[t]=[e,i,n]},n.setCompleteAction=function(t,e){this.complateFunc=t,this.complateObj=e,this.addEventListener(egret.Event.COMPLETE,this.onPlayend,this)},n.onPlayend=function(){this.complateFunc&&this.complateFunc.call(this.complateObj)},n.goToPlay=function(t){this.preFrame=-1,this.currFrameName=t,this.gotoAndPlay(t)},n.setCurrentFrame=function(e){t.prototype.setCurrentFrame.call(this,e);var i=this.getCurrentFrame();if(this.preFrame!=i&&(this.preFrame=i,this.frameActions&&this.frameActions[i])){var n=this.frameActions[i];n[2]?n[0].call(n[1],n[2]):n[0].call(n[1])}},n.dispose=function(){this.stop(),this.removeEventListener(egret.Event.COMPLETE,this.onPlayend,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemove,this),App.DisplayUtils.removeFromParent(this),this.complateFunc=null,this.complateObj=null,this.frameActions=null},e}(starlingswf.SwfMovieClip);egret.registerClass(StarlingSwfMovieClip,"StarlingSwfMovieClip");var StarlingSwfUtils=function(){function t(){}var e=(__define,t);e.prototype;return t.addSwf=function(e){t.swfList.push(e)},t.removeSwf=function(e){var i=t.swfList.indexOf(e);-1!=i&&t.swfList.splice(i,1)},t.createSprite=function(e,i,n){void 0===i&&(i=null),void 0===n&&(n=null);for(var s=t.swfList.length,r=0;s>r;r++){var a=t.swfList[r];if(a.hasSprite(e))return a.createSprite(e,i,n)}return null},t.createImage=function(e,i){void 0===i&&(i=null);for(var n=t.swfList.length,s=0;n>s;s++){var r=t.swfList[s];if(r.hasImage(e))return r.createImage(e,i)}return null},t.getTexture=function(e){for(var i=t.swfList.length,n=0;i>n;n++){var s=t.swfList[n];if(s.hasImage(e))return s.getTexture(e)}return null},t.createMovie=function(e,i,n){void 0===i&&(i=null),void 0===n&&(n=null);for(var s=t.swfList.length,r=0;s>r;r++){var a=t.swfList[r];if(a.hasMovieClip(e))return a.createMovie(e,i,n)}return null},t.createS9Image=function(e,i){void 0===i&&(i=null);for(var n=t.swfList.length,s=0;n>s;s++){var r=t.swfList[s];if(r.hasS9Image(e))return r.createS9Image(e,i)}return null},t.createShapeImage=function(e,i){void 0===i&&(i=null);for(var n=t.swfList.length,s=0;n>s;s++){var r=t.swfList[s];if(r.hasShapeImage(e))return r.createShapeImage(e,i)}return null},t.getSwf=function(e){for(var i=t.swfList.length,n=0;i>n;n++){var s=t.swfList[n];if(s.name==e)return s}return null},t.fixButton=function(e,i,n){t.firstAddBtn&&(t.firstAddBtn=!1,egret.MainContext.instance.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),egret.MainContext.instance.stage.addEventListener(egret.Event.LEAVE_STAGE,this.onTouchEnd,this));var s=new StarlingSwfButtonData;s.btn=e,s.onClick=i,s.thisObj=n,t.btnList.push(s),e.touchEnabled=!0,e.gotoAndStop(0),e.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onBtnTouchBegin,e)},t.onBtnTouchBegin=function(e){for(var i=e.currentTarget,n=t.btnList.length,s=0;n>s;s++){var r=t.btnList[s];if(r.btn==i){r.touchStageX=e.stageX,r.touchStageY=e.stageY,i.gotoAndStop(1);break}}},t.onTouchEnd=function(e){for(var i=t.btnList.length,n=0;i>n;n++){var s=t.btnList[n];-1!=s.touchStageX&&(e.stageX&&Math.abs(s.touchStageX-e.stageX)<10&&Math.abs(s.touchStageY-e.stageY)<10&&s.onClick&&s.onClick.call(s.thisObj,e),s.touchStageX=-1,s.touchStageY=-1,s.btn.gotoAndStop(0))}},t.swfList=[],t.btnList=[],t.firstAddBtn=!0,t}();egret.registerClass(StarlingSwfUtils,"StarlingSwfUtils");var StarlingSwfButtonData=function(){function t(){this.touchStageX=-1,this.touchStageY=-1}var e=(__define,t);e.prototype;return t}();egret.registerClass(StarlingSwfButtonData,"StarlingSwfButtonData");var AllAsyncExecutor=function(){function t(){this._functions=new Array,this._complateNum=0}var e=(__define,t),i=e.prototype;return i.setCallBack=function(t,e){this._callBack=t,this._callBackTarget=e},i.regist=function(t,e){this._functions.push([t,e])},i.start=function(){App.ArrayUtils.forEach(this._functions,function(t){t[0].call(t[1])},this)},i.complate=function(){this._functions&&(this._complateNum++,this._complateNum==this._functions.length&&(this._callBack&&this._callBack.call(this._callBackTarget),this._callBack=null,this._callBackTarget=null,this._functions=null))},t}();egret.registerClass(AllAsyncExecutor,"AllAsyncExecutor");
var AnchorUtil=function(){function t(){}var e=(__define,t);e.prototype;return t.init=function(){t._propertyChange=Object.create(null),t._anchorChange=Object.create(null),t.injectAnchor()},t.setAnchorX=function(t,e){t.anchorX=e},t.setAnchorY=function(t,e){t.anchorY=e},t.setAnchor=function(t,e){t.anchorX=t.anchorY=e},t.getAnchor=function(t){return t.anchorX!=t.anchorY&&console.log("target's anchorX != anchorY"),t.anchorX||0},t.getAnchorY=function(t){return t.anchorY||0},t.getAnchorX=function(t){return t.anchorX||0},t.injectAnchor=function(){Object.defineProperty(egret.DisplayObject.prototype,"width",{get:function(){return this.$getWidth()},set:function(e){var i=this;this.$setWidth(e),t._propertyChange[this.hashCode]=!0,egret.callLater(function(){t.changeAnchor(i)},this)},enumerable:!0,configurable:!0}),Object.defineProperty(egret.DisplayObject.prototype,"height",{get:function(){return this.$getHeight()},set:function(e){var i=this;this.$setHeight(e),t._propertyChange[this.hashCode]=!0,egret.callLater(function(){t.changeAnchor(i)},this)},enumerable:!0,configurable:!0}),Object.defineProperty(egret.DisplayObject.prototype,"anchorX",{get:function(){return this._anchorX},set:function(e){var i=this;this._anchorX=e,t._propertyChange[this.hashCode]=!0,t._anchorChange[this.hashCode]=!0,egret.callLater(function(){t.changeAnchor(i)},this)},enumerable:!0,configurable:!0}),Object.defineProperty(egret.DisplayObject.prototype,"anchorY",{get:function(){return this._anchorY},set:function(e){var i=this;this._anchorY=e,t._propertyChange[this.hashCode]=!0,t._anchorChange[this.hashCode]=!0,egret.callLater(function(){t.changeAnchor(i)},this)},enumerable:!0,configurable:!0})},t.changeAnchor=function(e){t._propertyChange[e.hashCode]&&t._anchorChange[e.hashCode]&&(e.anchorOffsetX=e._anchorX*e.width,e.anchorOffsetY=e._anchorY*e.height,delete t._propertyChange[e.hashCode])},t}();egret.registerClass(AnchorUtil,"AnchorUtil");var ArrayUtils=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.forEach=function(t,e,i){for(var n=0,s=t.length;s>n;n++)e.apply(i,[t[n]])},e}(BaseClass);egret.registerClass(ArrayUtils,"ArrayUtils");var AverageUtils=function(){function t(t){void 0===t&&(t=10),this.nums=[],this.numsLen=0,this.numSum=0,this.maxNum=t}var e=(__define,t),i=e.prototype;return i.push=function(t){this.numsLen>this.maxNum&&(this.numsLen--,this.numSum-=this.nums.shift()),this.nums.push(t),this.numSum+=t,this.numsLen++},i.getValue=function(){return this.numSum/this.numsLen},i.clear=function(){this.nums.splice(0),this.numsLen=0,this.numSum=0},t}();egret.registerClass(AverageUtils,"AverageUtils");var CommonUtils=function(t){function e(){t.call(this)}__extends(e,t);var i=(__define,e);i.prototype;return e.addLableStrokeColor=function(t,e,i){t.strokeColor=e,t.stroke=i},e.copyDataHandler=function(t){var e;if(t instanceof Array)e=[];else{if(!(t instanceof Object))return t;e={}}for(var i=Object.keys(t),n=0,s=i.length;s>n;n++){var r=i[n];e[r]=this.copyDataHandler(t[r])}return e},e.lock=function(){App.StageUtils.getStage().touchEnabled=App.StageUtils.getStage().touchChildren=!1},e.unlock=function(){App.StageUtils.getStage().touchEnabled=App.StageUtils.getStage().touchChildren=!0},e.int64ToNumber=function(t){return parseInt(t.toString())},e.labelIsOverLenght=function(t,e){var i=null;i=1e5>e?e:1e6>e?Math.floor(e/1e3/10).toString()+"万":Math.floor(e/1e4).toString()+"万",t.text=i},e}(BaseClass);egret.registerClass(CommonUtils,"CommonUtils");var DateUtils=function(t){function e(){t.call(this)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.getFormatBySecond=function(t,e){void 0===e&&(e=1);var i="";switch(e){case 1:i=this.getFormatBySecond1(t);break;case 2:i=this.getFormatBySecond2(t);break;case 3:i=this.getFormatBySecond3(t);break;case 4:i=this.getFormatBySecond4(t);break;case 5:i=this.getFormatBySecond5(t)}return i},n.getFormatBySecond1=function(t){void 0===t&&(t=0);var e,i=Math.floor(t/3600);e=0==i?"00":10>i?"0"+i:""+i;var n,s,r=Math.floor((t-3600*i)/60),a=Math.floor((t-3600*i)%60);return n=0==r?"00":10>r?"0"+r:""+r,s=0==a?"00":10>a?"0"+a:""+a,e+":"+n+":"+s},n.getFormatBySecond3=function(t){void 0===t&&(t=0);var e,i,n=Math.floor(t/3600),s=Math.floor((t-3600*n)/60),r=Math.floor((t-3600*n)%60);return e=0==s?"00":10>s?"0"+s:""+s,i=0==r?"00":10>r?"0"+r:""+r,e+":"+i},n.getFormatBySecond2=function(t){var e=new Date(t),i=e.getFullYear(),n=e.getMonth()+1,s=e.getDate(),r=e.getHours(),a=e.getMinutes(),o=e.getSeconds();return i+"-"+n+"-"+s+" "+r+":"+a+":"+o},n.getFormatBySecond4=function(t){var e=Math.floor(t/3600);return e>0?e>24?Math.floor(e/24)+"天前":e+"小时前":Math.floor(t/60)+"分钟前"},n.getFormatBySecond5=function(t){var e=86400,i=3600,n=60,s=Math.floor(t/e),r=Math.floor(t%e/i),a=Math.floor((t-r*i)/n),o=Math.floor((t-r*i)%n),h="",l="",c="",u="";return t>0?0==s?(h="",0==r?(l="",0==a?(c="",u=0==o?"":10>o?"0"+o+"秒":""+o+"秒"):(c=""+a+"分",u=0==o?"":10>o?"0"+o+"秒":""+o+"秒",c+u)):(l=r+"小时",0==a?(c="",u=0==o?"":10>o?"0"+o+"秒":""+o+"秒"):(c=10>a?"0"+a+"分":""+a+"分",l+c))):(h=s+"天",l=0==r?"":10>r?"0"+r+"小时":""+r+"小时",h+l):""},e}(BaseClass);egret.registerClass(DateUtils,"DateUtils");var DebugUtils=function(t){function e(){t.call(this),this._threshold=3,this._startTimes={}}__extends(e,t);var i=__define,n=e,s=n.prototype;return s.isOpen=function(t){this._isOpen=t},i(s,"isDebug",function(){return this._isOpen}),s.start=function(t){this._isOpen&&(this._startTimes[t]=egret.getTimer())},s.stop=function(t){if(!this._isOpen)return 0;if(!this._startTimes[t])return 0;var e=egret.getTimer()-this._startTimes[t];return e>this._threshold&&Log.trace(t+": "+e),e},s.setThreshold=function(t){this._threshold=t},e}(BaseClass);egret.registerClass(DebugUtils,"DebugUtils");var DelayOptManager=function(t){function e(){t.call(this),this.TIME_THRESHOLD=2,this._delayOpts=[],App.TimerManager.doFrame(1,0,this.runCachedFun,this)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.addDelayOptFunction=function(t,e,i,n,s){this._delayOpts.push({fun:e,funPara:i,thisObj:t,callBack:n,para:s})},n.clear=function(){this._delayOpts.length=0},n.stop=function(){App.TimerManager.remove(this.runCachedFun,this)},n.runCachedFun=function(t){if(0!=this._delayOpts.length)for(var e,i=egret.getTimer();this._delayOpts.length&&(e=this._delayOpts.shift(),e.funPara?e.fun.call(e.thisObj,e.funPara):e.fun.call(e.thisObj),e.callBack&&(void 0!=e.para?e.callBack.call(e.thisObj,e.para):e.callBack()),!(egret.getTimer()-i>this.TIME_THRESHOLD)););},e}(BaseClass);egret.registerClass(DelayOptManager,"DelayOptManager");var DeviceUtils=function(t){function e(){t.call(this)}__extends(e,t);var i=__define,n=e,s=n.prototype;return i(s,"IsHtml5",function(){return egret.Capabilities.runtimeType==egret.RuntimeType.WEB}),i(s,"IsNative",function(){return egret.Capabilities.runtimeType==egret.RuntimeType.NATIVE}),i(s,"IsMobile",function(){return egret.Capabilities.isMobile}),i(s,"IsPC",function(){return!egret.Capabilities.isMobile}),i(s,"IsQQBrowser",function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("MQQBrowser")}),i(s,"IsIEBrowser",function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("MSIE")}),i(s,"IsFirefoxBrowser",function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("Firefox")}),i(s,"IsChromeBrowser",function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("Chrome")}),i(s,"IsSafariBrowser",function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("Safari")}),i(s,"IsOperaBrowser",function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("Opera")}),e}(BaseClass);egret.registerClass(DeviceUtils,"DeviceUtils");var DisplayUtils=function(t){function e(){t.call(this)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.createBitmap=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},n.createEuiImage=function(t){var e=new eui.Image,i=RES.getRes(t);return e.source=i,e},n.removeFromParent=function(t){null!=t.parent&&t.parent.removeChild(t)},e}(BaseClass);egret.registerClass(DisplayUtils,"DisplayUtils");var EffectUtils=function(t){function e(){t.call(this)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.macIconShake=function(t,e){for(var i=[[20,300],[15,300],[10,300],[5,300]],n="egret.Tween.get("+t+")",s=0,r=i.length;r>s;s++)n+=".to({'y':"+e+"-"+i[s][0]+"}, "+i[s][1]+")",n+=".to({'y':"+e+"}, "+i[s][1]+")";return n+=";"},n.startFlicker=function(t,e){t.alpha=1,egret.Tween.get(t).to({alpha:0},e).to({alpha:1},e).call(this.startFlicker,this,[t])},n.stopFlicker=function(t){egret.Tween.removeTweens(t)},e}(BaseClass);egret.registerClass(EffectUtils,"EffectUtils");var EgretExpandUtils=function(t){function e(){t.call(this)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.init=function(){AnchorUtil.init()},e}(BaseClass);egret.registerClass(EgretExpandUtils,"EgretExpandUtils");var FrameDelay=function(){function t(){}var e=(__define,t),i=e.prototype;return i.delayCall=function(t,e,i){this.func=e,this.thisObj=i,App.TimerManager.doFrame(t,1,this.listener_enterFrame,this)},i.listener_enterFrame=function(){this.func.call(this.thisObj)},t}();egret.registerClass(FrameDelay,"FrameDelay");var FrameExecutor=function(){function t(t){this.delayFrame=t,this.frameDelay=new FrameDelay,this.functions=new Array}var e=(__define,t),i=e.prototype;return i.regist=function(t,e){this.functions.push([t,e])},i.execute=function(){if(this.functions.length){var t=this.functions.shift();t[0].call(t[1]),this.frameDelay.delayCall(this.delayFrame,this.execute,this)}},t}();egret.registerClass(FrameExecutor,"FrameExecutor");var KeyboardUtils=function(t){function e(){if(t.call(this),this.key_ups=new Array,this.key_downs=new Array,App.DeviceUtils.IsHtml5){var e=this;document.addEventListener("keyup",function(t){for(var i=0,n=e.key_ups.length;n>i;i++){var s=e.key_ups[i][0],r=e.key_ups[i][1];r?s.call(r,t.keyCode):s(t.keyCode)}}),document.addEventListener("keydown",function(t){for(var i=0,n=e.key_downs.length;n>i;i++){var s=e.key_downs[i][0],r=e.key_downs[i][1];r?s.call(r,t.keyCode):s(t.keyCode)}})}}__extends(e,t);var i=(__define,e),n=i.prototype;return n.addKeyUp=function(t,e){this.key_ups.push([t,e])},n.addKeyDown=function(t,e){this.key_downs.push([t,e])},n.removeKeyUp=function(t,e){for(var i=0;i<this.key_ups.length;i++)this.key_ups[i][0]==t&&this.key_ups[i][1]==e&&(this.key_ups.splice(i,1),i--)},n.removeKeyDown=function(t,e){for(var i=0;i<this.key_downs.length;i++)this.key_downs[i][0]==t&&this.key_downs[i][1]==e&&(this.key_downs.splice(i,1),i--)},e}(BaseClass);egret.registerClass(KeyboardUtils,"KeyboardUtils");var LocationProperty=function(){function t(){}var e=(__define,t);e.prototype;return t.getPara=function(t,e){if(egret.MainContext.runtimeType==egret.MainContext.RUNTIME_NATIVE)return null;var i=e||location.href;if(-1!=i.indexOf("?")){var n="&"+i.split("?")[1],s=new RegExp("&"+t+"=.*?(?:&|$)"),r=s.exec(n);if(r){var a=r[0];return a.split("&")[1].split("=")[1]}}return null},t.setProperty=function(t,e,i){var n=i||location.href,s="&"+n.split("?")[1];if(-1==n.indexOf("?"))return n+="?"+t+"="+e;var s=n.split("?")[1];if(""==s)return n+=t+"="+e;var r=new RegExp("(?:^|&)"+t+"=.*?(?:&|$)"),a=r.exec(s);if(a&&""!=a[0]){var o=a[0],h=new RegExp("=.*$"),l=o.replace(h,"="+e);return n.replace(o,l)}return n+="&"+t+"="+e},t.hasProperty=function(t,e){var i=e||location.href,n="&"+i.split("?")[1];return-1!=n.indexOf("&"+t+"=")},t}();egret.registerClass(LocationProperty,"LocationProperty");var Log=function(){function t(){}var e=(__define,t);e.prototype;return t.trace=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];App.DebugUtils.isDebug&&(t[0]="[DebugLog]"+t[0],console.log.apply(console,t))},t}();egret.registerClass(Log,"Log");var MathUtils=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.getAngle=function(t){return 180*t/Math.PI},n.getRadian=function(t){return Math.PI=t/180*Math.PI},n.getRadian2=function(t,e,i,n){var s=i-t,r=n-e;return Math.atan2(r,s)},n.getDistance=function(t,e,i,n){var s=i-t,r=n-e,a=s*s+r*r;return Math.sqrt(a)},e}(BaseClass);egret.registerClass(MathUtils,"MathUtils");var MessageCenter=function(t){function e(e){t.call(this),this.type=e,this.dict={},this.eVec=new Array,this.lastRunTime=0,0==this.type&&App.TimerManager.doFrame(1,0,this.run,this)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.clear=function(){this.dict={},this.eVec.splice(0)},n.addListener=function(t,e,i){var n=this.dict[t];null==n&&(n=new Array,this.dict[t]=n);var s=0,r=n.length;for(s;r>s;s++)if(n[s][0]==e&&n[s][1]==i)return;n.push([e,i])},n.removeListener=function(t,e,i){var n=this.dict[t];if(null!=n){var s=0,r=n.length;for(s;r>s;s++)if(n[s][0]==e&&n[s][1]==i){n.splice(s,1);break}0==n.length&&(this.dict[t]=null,delete this.dict[t])}},n.removeAll=function(t){for(var e=Object.keys(this.dict),i=0,n=e.length;n>i;i++){for(var s=e[i],r=this.dict[s],a=0;a<r.length;a++)r[a][1]==t&&(r.splice(a,1),a--);0==r.length&&(this.dict[s]=null,delete this.dict[s])}},n.dispatch=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(null!=this.dict[t]){var n=ObjectPool.pop("MessageVo");n.type=t,n.param=e,0==this.type?this.eVec.push(n):1==this.type?this.dealMsg(n):Log.trace("MessageCenter未实现的类型")}},n.run=function(){var t=egret.getTimer(),e=t-this.lastRunTime>100;if(this.lastRunTime=t,e)for(;this.eVec.length>0;)this.dealMsg(this.eVec.shift());else for(;this.eVec.length>0&&(this.dealMsg(this.eVec.shift()),!(egret.getTimer()-t>5)););},n.dealMsg=function(t){for(var e=this.dict[t.type],i=0,n=e.length,s=null;n>i;)s=e[i],s[0].apply(s[1],t.param),e.length!=n&&(n=e.length,i--),i++;t.dispose(),ObjectPool.push(t)},e}(BaseClass);egret.registerClass(MessageCenter,"MessageCenter");var MessageVo=function(){function t(){}var e=(__define,t),i=e.prototype;return i.dispose=function(){this.type=null,this.param=null},t}();egret.registerClass(MessageVo,"MessageVo");var ObjectPool=function(){function t(){this._objs=new Array}var e=(__define,t),i=e.prototype;return i.pushObj=function(t){this._objs.push(t)},i.popObj=function(){return this._objs.length>0?this._objs.pop():null},i.clear=function(){for(;this._objs.length>0;)this._objs.pop()},t.pop=function(e){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];t._content[e]||(t._content[e]=[]);var s=t._content[e];if(s.length)return s.pop();var r,a=egret.getDefinitionByName(e),o=i.length;return 0==o?r=new a:1==o?r=new a(i[0]):2==o?r=new a(i[0],i[1]):3==o?r=new a(i[0],i[1],i[2]):4==o?r=new a(i[0],i[1],i[2],i[3]):5==o&&(r=new a(i[0],i[1],i[2],i[3],i[4])),r.ObjectPoolKey=e,r},t.popWithExtraKey=function(e,i){t._content[e]||(t._content[e]=[]);var n,s=t._content[e];if(s.length)for(var r=0;r<s.length;r++)if(s[r].extraKey==i){n=s[r],s.splice(r,1);break}if(!n){var a=egret.getDefinitionByName(e);n=new a(i),n.extraKey=i,n.ObjectPoolKey=e}return n},t.push=function(e){if(null==e)return!1;var i=e.ObjectPoolKey;return t._content[i]?(t._content[i].push(e),!0):!1},t.clear=function(){t._content={}},t.clearClass=function(e,i){void 0===i&&(i=null);for(var n=t._content[e];n&&n.length;){var s=n.pop();i&&s[i](),s=null}t._content[e]=null,delete t._content[e]},t.dealFunc=function(e,i){var n=t._content[e];if(null!=n){var s=0,r=n.length;for(s;r>s;s++)n[s][i]()}},t._content={},t}();egret.registerClass(ObjectPool,"ObjectPool");var Percent=function(){function t(t,e){this.currentValue=t,this.totalValue=e}var e=(__define,t),i=e.prototype;return i.computePercent=function(){return this.currentValue/this.totalValue*100},i.computeRate=function(){return this.currentValue/this.totalValue},i.reverse=function(){return this.currentValue=this.totalValue-this.currentValue,this},i.copy=function(){return new t(this.currentValue,this.totalValue)},i.computePercentReverse=function(){return(this.totalValue-this.currentValue)/this.totalValue*100},i.computeRateReverse=function(){return(this.totalValue-this.currentValue)/this.totalValue},t}();egret.registerClass(Percent,"Percent");var QueueExecutor=function(){function t(){this._functions=new Array}var e=(__define,t),i=e.prototype;return i.setCallBack=function(t,e){this._callBack=t,this._callBackTarget=e},i.regist=function(t,e){this._functions.push([t,e])},i.start=function(){this.next()},i.next=function(){if(this._functions)if(0==this._functions.length)this._callBack&&this._callBack.call(this._callBackTarget),this._callBack=null,this._callBackTarget=null,this._functions=null;else{var t=this._functions.shift();t[0].call(t[1])}},t}();egret.registerClass(QueueExecutor,"QueueExecutor");var RandomUtils=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.limit=function(t,e){t=Math.min(t,e),e=Math.max(t,e);var i=e-t;return t+Math.random()*i},n.limitInteger=function(t,e){return Math.round(this.limit(t,e))},n.randomArray=function(t){var e=Math.floor(Math.random()*t.length);return t[e]},e}(BaseClass);egret.registerClass(RandomUtils,"RandomUtils");var RenderTextureManager=function(t){function e(){t.call(this),this._pool=[],this._useNum=0,this.isLowerQQBrowser()?this._maxNum=18:this._maxNum=-1}__extends(e,t);var i=(__define,e),n=i.prototype;return n.isLowerQQBrowser=function(){if(App.DeviceUtils.IsQQBrowser){for(var t=["2013022","Lenovo A630t","SM-G3818","vivo X3t","GT-I9100"],e=!1,i=0,n=t.length;n>i;i++)if(-1!=navigator.userAgent.indexOf(t[i])){e=!0;break}return e}return!1},n.pop=function(){var t=this._pool.pop();return t||(-1==this._maxNum||this._useNum<this._maxNum)&&(t=new egret.RenderTexture,this._useNum++),t},n.push=function(t){for(var e=!1,i=0,n=this._pool.length;n>i;i++)if(this._pool[i]==t){e=!0;break}e||this._pool.push(t)},e}(BaseClass);egret.registerClass(RenderTextureManager,"RenderTextureManager");var ResVersionManager=function(t){function e(){t.call(this),this.res_loadByVersion()}__extends(e,t);var i=(__define,e),n=i.prototype;return n.res_loadByVersion=function(){RES.web.Html5VersionController.prototype.getVirtualUrl=function(t){var i="",n=e.resVersionData,s=t.substring(9);return n&&n[s]&&(i=n[s]),0==i.length&&(i=Math.random()+""),t+=-1==t.indexOf("?")?"?v="+i:"&v="+i}},n.loadConfig=function(t,e,i){this.complateFunc=e,this.complateFuncTarget=i,RES.getResByUrl(t,this.loadResVersionComplate,this)},n.loadResVersionComplate=function(t){e.resVersionData=t,this.complateFunc.call(this.complateFuncTarget)},e}(BaseClass);egret.registerClass(ResVersionManager,"ResVersionManager");var ResourceUtils=function(t){function e(){t.call(this),this._groupIndex=0,this._configs=new Array,this._groups={},RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceLoadProgress,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.addConfig=function(t,e){this._configs.push([t,e])},n.loadConfig=function(t,e){this._onConfigComplete=t,this._onConfigCompleteTarget=e,this.loadNextConfig()},n.loadNextConfig=function(){if(0==this._configs.length)return this._onConfigComplete.call(this._onConfigCompleteTarget),this._onConfigComplete=null,void(this._onConfigCompleteTarget=null);var t=this._configs.shift();RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigCompleteHandle,this),RES.loadConfig(t[0],t[1])},n.onConfigCompleteHandle=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigCompleteHandle,this),this.loadNextConfig()},n.loadGroup=function(t,e,i,n){this._groups[t]=[e,i,n],RES.loadGroup(t)},n.loadGroups=function(t,e,i,n,s){RES.createGroup(t,e,!0),this.loadGroup(t,i,n,s)},n.pilfererLoadGroup=function(t,e){void 0===e&&(e=null);var i="pilferer_"+t;e||(e=[t]),RES.createGroup(i,e,!0),RES.loadGroup(i,-1)},n.onResourceLoadComplete=function(t){var e=t.groupName;if(this._groups[e]){var i=this._groups[e][0],n=this._groups[e][2];null!=i&&i.call(n),this._groups[e]=null,delete this._groups[e]}},n.onResourceLoadProgress=function(t){var e=t.groupName;if(this._groups[e]){var i=this._groups[e][1],n=this._groups[e][2];null!=i&&i.call(n,t.itemsLoaded,t.itemsTotal)}},n.onResourceLoadError=function(t){Log.trace(t.groupName+"资源组有资源加载失败"),this.onResourceLoadComplete(t)},n.loadResource=function(t,e,i,n,s){void 0===t&&(t=[]),void 0===e&&(e=[]),void 0===i&&(i=null),void 0===n&&(n=null),void 0===s&&(s=null);var r=t.concat(e),a="loadGroup"+this._groupIndex++;RES.createGroup(a,r,!0),this._groups[a]=[i,n,s],RES.loadGroup(a)},e}(BaseClass);egret.registerClass(ResourceUtils,"ResourceUtils");var RockerUtils=function(t){function e(){t.call(this)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.init=function(t,e,i,n){this.keys=[0,0],this.mouseX=-1,this.mouseY=-1,this.moveFlag=e,this.moveFlagX=e.x,this.moveFlagY=e.y,this.moveFlagGoX=this.moveFlagX,this.moveFlagGoY=this.moveFlagY,this.moveFlagWidthHelf=.5*t.width,this.moveFlagRec=new egret.Rectangle(this.moveFlagX-.5*t.width,this.moveFlagY-.5*t.height,t.width,t.height),this.moveFlagCheckRec=new egret.Rectangle(0,0,.5*App.StageUtils.getWidth(),App.StageUtils.getHeight()),this.dealKeyFunc=i,this.dealKeyTarget=n,this.moveFlag.touchEnabled=!0,this.moveFlag.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.startMove,this),this.moveFlag.addEventListener(egret.TouchEvent.TOUCH_END,this.stopMove,this),this.moveFlag.addEventListener(egret.TouchEvent.TOUCH_TAP,this.stopEvent,this),App.StageUtils.getStage().addEventListener(egret.TouchEvent.TOUCH_END,this.leaveStateEvent,this),App.StageUtils.getStage().addEventListener(egret.TouchEvent.TOUCH_MOVE,this.heroMoveEvent,this),App.KeyboardUtils.addKeyDown(this.onKeyDown,this),App.KeyboardUtils.addKeyUp(this.onKeyUp,this)},n.onKeyDown=function(t){switch(t){case Keyboard.A:this.keys[0]=-1,this.startCheckKey();break;case Keyboard.D:this.keys[0]=1,this.startCheckKey();break;case Keyboard.W:this.keys[1]=-1,this.startCheckKey();break;case Keyboard.S:this.keys[1]=1,this.startCheckKey()}},n.onKeyUp=function(t){switch(t){case Keyboard.A:-1==this.keys[0]&&(this.keys[0]=0);break;case Keyboard.D:1==this.keys[0]&&(this.keys[0]=0);break;case Keyboard.W:-1==this.keys[1]&&(this.keys[1]=0);break;case Keyboard.S:1==this.keys[1]&&(this.keys[1]=0)}},n.stopEvent=function(t){t.stopPropagation()},n.leaveStateEvent=function(t){t.stageX==this.mouseX&&t.stageY==this.mouseY&&this.stopMove()},n.startMove=function(t){this.isMoveing=!0,this.moveFlagGoX=this.moveFlagX,this.moveFlagGoY=this.moveFlagY,this.mouseX=t.stageX,this.mouseY=t.stageY},n.stopMove=function(){this.isMoveing=!1,this.keys[0]=0,this.keys[1]=0,this.moveFlagGoX=this.moveFlagX,this.moveFlagGoY=this.moveFlagY,this.mouseX=-1,this.mouseY=-1},n.resetRockerPos=function(){this.moveFlag.x=this.moveFlagX,this.moveFlag.y=this.moveFlagY},n.heroMoveEvent=function(t){this.runMove(t.stageX,t.stageY)},n.runMove=function(t,e){if(this.isMoveing&&(this.moveFlagCheckRec.contains(t,e)||!(Math.abs(this.mouseX-t)>50||Math.abs(this.mouseY-e)>50))){if(this.mouseX=t,this.mouseY=e,this.moveFlagRec.contains(this.mouseX,this.mouseY))this.moveFlagGoX=this.mouseX,this.moveFlagGoY=this.mouseY;else{var i=App.MathUtils.getRadian2(this.moveFlagX,this.moveFlagY,this.mouseX,this.mouseY);this.moveFlagGoX=this.moveFlagX+Math.cos(i)*this.moveFlagWidthHelf,this.moveFlagGoY=this.moveFlagY+Math.sin(i)*this.moveFlagWidthHelf}this.moveFlagGoX>this.moveFlagX&&Math.abs(this.moveFlagGoX-this.moveFlagX)>10?this.keys[0]=1:this.moveFlagGoX<this.moveFlagX&&Math.abs(this.moveFlagGoX-this.moveFlagX)>10?this.keys[0]=-1:this.keys[0]=0,this.moveFlagGoY>this.moveFlagY&&Math.abs(this.moveFlagGoY-this.moveFlagY)>10?this.keys[1]=1:this.moveFlagGoY<this.moveFlagY&&Math.abs(this.moveFlagGoY-this.moveFlagY)>10?this.keys[1]=-1:this.keys[1]=0,this.startCheckKey()}},n.startCheckKey=function(){this.checkKeying||(this.checkKeying=!0,App.TimerManager.doFrame(1,0,this.delKeys,this))},n.stopCheckKey=function(){this.keys[0]=0,this.keys[1]=0,this.checkKeying&&(App.TimerManager.remove(this.delKeys,this),this.checkKeying=!1)},n.delKeys=function(){-1==this.mouseX||this.moveFlagCheckRec.contains(this.mouseX,this.mouseY)||this.stopMove(),this.moveFlag.x!=this.moveFlagGoX&&(this.moveFlag.x=this.moveFlagGoX),this.moveFlag.y!=this.moveFlagGoY&&(this.moveFlag.y=this.moveFlagGoY),this.keys[0]||this.keys[1]||this.stopCheckKey(),this.dealKeyFunc.call(this.dealKeyTarget,this.keys[0],this.keys[1])||this.resetRockerPos()},n.stop=function(){this.stopCheckKey(),this.stopMove()},e}(BaseClass);egret.registerClass(RockerUtils,"RockerUtils");var ShockUtils=function(t){function e(){t.call(this),this.MAP=0,this.SPRITE=1,this.mapPoss=[new egret.Point(0,3),new egret.Point(0,0),new egret.Point(0,-2)],this.spritePoss=[new egret.Point(5,0),new egret.Point(-5,0),new egret.Point(5,0)],this._shockLength=0,this._shockCount=0,this._rx=0,this._ry=0,this._type=0,this._repeatCount=0}__extends(e,t);var i=__define,n=e,s=n.prototype;return s.destroy=function(){this.stop()},s.shock=function(t,e,i){void 0===t&&(t=0),void 0===e&&(e=null),void 0===i&&(i=3),this._target||(this._type=t,this._target=e,this._type==this.MAP?(this._shockPoss=this.mapPoss.concat(),this._shockLength=this._shockPoss.length):this._type==this.SPRITE&&(this._shockPoss=this.spritePoss.concat(),this._shockLength=this._shockPoss.length),this.start(i))},s.start=function(t){void 0===t&&(t=1),this.repeatCount=t,this._shockCount=0,this._target&&(this._type!=this.MAP&&(this._rx=this._target.x),this._ry=this._target.y,App.TimerManager.doFrame(1,0,this.onShockEnter,this))},s.stop=function(){this._target&&(this._type!=this.MAP&&(this._target.x=this._rx),this._target.y=this._ry,App.TimerManager.remove(this.onShockEnter,this)),this._target=null},s.onShockEnter=function(t){var e=this._shockLength*this._repeatCount;if(this._shockCount>=e)return void this.stop();var i=this._shockCount%this._shockLength,n=this._shockPoss[i];this._target&&(this._type!=this.MAP&&(this._target.x=this._rx+n.x),this._target.y=this._ry+n.y),this._shockCount++},i(s,"repeatCount",function(){return this._repeatCount},function(t){this._repeatCount=t}),e}(BaseClass);egret.registerClass(ShockUtils,"ShockUtils");var StageUtils=function(t){function e(){t.call(this),null==e._uiStage&&(e._uiStage=new eui.UILayer,e._uiStage.percentHeight=100,e._uiStage.percentWidth=100,e._uiStage.touchEnabled=!1,this.getStage().addChild(e._uiStage))}__extends(e,t);var i=(__define,e),n=i.prototype;return n.getHeight=function(){return this.getStage().stageHeight},n.getWidth=function(){return this.getStage().stageWidth},n.setTouchChildren=function(t){this.getStage().touchChildren=t},n.setMaxTouches=function(t){this.getStage().maxTouches=t},n.setFrameRate=function(t){this.getStage().frameRate=t},n.setScaleMode=function(t){this.getStage().scaleMode=t},n.getStage=function(){return egret.MainContext.instance.stage},n.getUIStage=function(){return e._uiStage},e}(BaseClass);egret.registerClass(StageUtils,"StageUtils");var StringBuffer=function(){function t(){this._strings=new Array}var e=(__define,t),i=e.prototype;return i.append=function(t){this._strings.push(t)},i.toString=function(){return this._strings.join("")},i.clear=function(){this._strings.length=0},t}();egret.registerClass(StringBuffer,"StringBuffer");var StringUtils=function(t){function e(){t.call(this)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.trimSpace=function(t){return t.replace(/^\s*(.*?)[\s\n]*$/g,"$1")},n.getStringLength=function(t){for(var e=t.split(""),i=0,n=0;n<e.length;n++){var s=e[n];i+=this.isChinese(s)?2:1}return i},n.isChinese=function(t){var e=/^.*[\u4E00-\u9FA5]+.*$/;return e.test(t)},e}(BaseClass);egret.registerClass(StringUtils,"StringUtils");var TextFlowMaker=function(t){function e(){t.call(this),this.STYLE_COLOR="C",this.STYLE_SIZE="S",this.PROP_TEXT="T"}__extends(e,t);var i=(__define,e),n=i.prototype;return n.generateTextFlow=function(t){for(var e=t.split("|"),i=[],n=0,s=e.length;s>n;n++)i.push(this.getSingleTextFlow(e[n]));return i},n.getSingleTextFlow=function(t){for(var e,i=t.split("&"),n={style:{}},s=0,r=i.length;r>s;s++)e=i[s].split(":"),e[0]==this.PROP_TEXT?n.text=e[1]:e[0]==this.STYLE_SIZE?n.style.size=parseInt(e[1]):e[0]==this.STYLE_COLOR?n.style.textColor=parseInt(e[1]):n.text=e[0];return n},e}(BaseClass);egret.registerClass(TextFlowMaker,"TextFlowMaker");var TimerManager=function(t){function e(){t.call(this),this._handlers=new Array,this._delHandlers=new Array,this._currTime=egret.getTimer(),this._currFrame=0,this._count=0,this._timeScale=1,egret.Ticker.getInstance().register(this.onEnterFrame,this)}__extends(e,t);var i=__define,n=e,s=n.prototype;return s.setTimeScale=function(t){this._timeScale=t},s.onEnterFrame=function(){this._currFrame++,this._currTime=egret.getTimer(),App.DebugUtils.start("TimerManager:");for(var t=0;t<this._count;t++){var e=this._handlers[t],i=e.userFrame?this._currFrame:this._currTime;i>=e.exeTime&&(App.DebugUtils.start(e.method.toString()),e.method.call(e.methodObj,(this._currTime-e.dealTime)*this._timeScale),App.DebugUtils.stop(e.method.toString()),e.dealTime=this._currTime,e.exeTime+=e.delay,e.repeat||(e.repeatCount>1?e.repeatCount--:(e.complateMethod&&e.complateMethod.apply(e.complateMethodObj),this._delHandlers.push(e))))}for(;this._delHandlers.length;){var e=this._delHandlers.pop();this.remove(e.method,e.methodObj)}App.DebugUtils.stop("TimerManager:")},s.create=function(t,e,i,n,s,r,a){if(!(0>e||0>i||null==n)){this.remove(n,s);var o=ObjectPool.pop("TimerHandler");o.userFrame=t,o.repeat=0==i,o.repeatCount=i,o.delay=e,o.method=n,o.methodObj=s,o.complateMethod=r,o.complateMethodObj=a,o.exeTime=e+(t?this._currFrame:this._currTime),o.dealTime=this._currTime,this._handlers.push(o),this._count++}},s.doTimer=function(t,e,i,n,s,r){void 0===s&&(s=null),void 0===r&&(r=null),this.create(!1,t,e,i,n,s,r)},s.doFrame=function(t,e,i,n,s,r){void 0===s&&(s=null),void 0===r&&(r=null),this.create(!0,t,e,i,n,s,r)},i(s,"count",function(){return this._count}),s.remove=function(t,e){for(var i=0;i<this._count;i++){var n=this._handlers[i];if(n.method==t&&n.methodObj==e){this._handlers.splice(i,1),ObjectPool.push(n),this._count--;break}}},s.removeAll=function(t){for(var e=0;e<this._count;e++){var i=this._handlers[e];i.methodObj==t&&(this._handlers.splice(e,1),ObjectPool.push(i),this._count--,e--)}},s.isExists=function(t,e){for(var i=0;i<this._count;i++){var n=this._handlers[i];if(n.method==t&&n.methodObj==e)return!0}return!1},e}(BaseClass);egret.registerClass(TimerManager,"TimerManager");var TimerHandler=function(){function t(){this.delay=0,this.repeatCount=0,this.exeTime=0,this.dealTime=0}var e=(__define,t),i=e.prototype;return i.clear=function(){this.method=null,this.methodObj=null,this.complateMethod=null,this.complateMethodObj=null},t}();egret.registerClass(TimerHandler,"TimerHandler");var md5=function(){function t(){this.hexcase=0,this.b64pad=""}var e=(__define,t),i=e.prototype;return i.hex_md5=function(t){return this.rstr2hex(this.rstr_md5(this.str2rstr_utf8(t)))},i.b64_md5=function(t){return this.rstr2b64(this.rstr_md5(this.str2rstr_utf8(t)))},i.any_md5=function(t,e){return this.rstr2any(this.rstr_md5(this.str2rstr_utf8(t)),e)},i.hex_hmac_md5=function(t,e){return this.rstr2hex(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)))},i.b64_hmac_md5=function(t,e){return this.rstr2b64(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)))},i.any_hmac_md5=function(t,e,i){return this.rstr2any(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)),i)},i.md5_vm_test=function(){return"900150983cd24fb0d6963f7d28e17f72"==this.hex_md5("abc").toLowerCase()},i.rstr_md5=function(t){return this.binl2rstr(this.binl_md5(this.rstr2binl(t),8*t.length))},i.rstr_hmac_md5=function(t,e){var i=this.rstr2binl(t);i.length>16&&(i=this.binl_md5(i,8*t.length));for(var n=Array(16),s=Array(16),r=0;16>r;r++)n[r]=909522486^i[r],s[r]=1549556828^i[r];var a=this.binl_md5(n.concat(this.rstr2binl(e)),512+8*e.length);return this.binl2rstr(this.binl_md5(s.concat(a),640))},i.rstr2hex=function(t){try{this.hexcase}catch(e){this.hexcase=0
}for(var i,n=this.hexcase?"0123456789ABCDEF":"0123456789abcdef",s="",r=0;r<t.length;r++)i=t.charCodeAt(r),s+=n.charAt(i>>>4&15)+n.charAt(15&i);return s},i.rstr2b64=function(t){try{this.b64pad}catch(e){this.b64pad=""}for(var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n="",s=t.length,r=0;s>r;r+=3)for(var a=t.charCodeAt(r)<<16|(s>r+1?t.charCodeAt(r+1)<<8:0)|(s>r+2?t.charCodeAt(r+2):0),o=0;4>o;o++)n+=8*r+6*o>8*t.length?this.b64pad:i.charAt(a>>>6*(3-o)&63);return n},i.rstr2any=function(t,e){var i,n,s,r,a,o=e.length,h=Array(Math.ceil(t.length/2));for(i=0;i<h.length;i++)h[i]=t.charCodeAt(2*i)<<8|t.charCodeAt(2*i+1);var l=Math.ceil(8*t.length/(Math.log(e.length)/Math.log(2))),c=Array(l);for(n=0;l>n;n++){for(a=Array(),r=0,i=0;i<h.length;i++)r=(r<<16)+h[i],s=Math.floor(r/o),r-=s*o,(a.length>0||s>0)&&(a[a.length]=s);c[n]=r,h=a}var u="";for(i=c.length-1;i>=0;i--)u+=e.charAt(c[i]);return u},i.str2rstr_utf8=function(t){for(var e,i,n="",s=-1;++s<t.length;)e=t.charCodeAt(s),i=s+1<t.length?t.charCodeAt(s+1):0,e>=55296&&56319>=e&&i>=56320&&57343>=i&&(e=65536+((1023&e)<<10)+(1023&i),s++),127>=e?n+=String.fromCharCode(e):2047>=e?n+=String.fromCharCode(192|e>>>6&31,128|63&e):65535>=e?n+=String.fromCharCode(224|e>>>12&15,128|e>>>6&63,128|63&e):2097151>=e&&(n+=String.fromCharCode(240|e>>>18&7,128|e>>>12&63,128|e>>>6&63,128|63&e));return n},i.str2rstr_utf16le=function(t){for(var e="",i=0;i<t.length;i++)e+=String.fromCharCode(255&t.charCodeAt(i),t.charCodeAt(i)>>>8&255);return e},i.str2rstr_utf16be=function(t){for(var e="",i=0;i<t.length;i++)e+=String.fromCharCode(t.charCodeAt(i)>>>8&255,255&t.charCodeAt(i));return e},i.rstr2binl=function(t){for(var e=Array(t.length>>2),i=0;i<e.length;i++)e[i]=0;for(var i=0;i<8*t.length;i+=8)e[i>>5]|=(255&t.charCodeAt(i/8))<<i%32;return e},i.binl2rstr=function(t){for(var e="",i=0;i<32*t.length;i+=8)e+=String.fromCharCode(t[i>>5]>>>i%32&255);return e},i.binl_md5=function(t,e){t[e>>5]|=128<<e%32,t[(e+64>>>9<<4)+14]=e;for(var i=1732584193,n=-271733879,s=-1732584194,r=271733878,a=0;a<t.length;a+=16){var o=i,h=n,l=s,c=r;i=this.md5_ff(i,n,s,r,t[a+0],7,-680876936),r=this.md5_ff(r,i,n,s,t[a+1],12,-389564586),s=this.md5_ff(s,r,i,n,t[a+2],17,606105819),n=this.md5_ff(n,s,r,i,t[a+3],22,-1044525330),i=this.md5_ff(i,n,s,r,t[a+4],7,-176418897),r=this.md5_ff(r,i,n,s,t[a+5],12,1200080426),s=this.md5_ff(s,r,i,n,t[a+6],17,-1473231341),n=this.md5_ff(n,s,r,i,t[a+7],22,-45705983),i=this.md5_ff(i,n,s,r,t[a+8],7,1770035416),r=this.md5_ff(r,i,n,s,t[a+9],12,-1958414417),s=this.md5_ff(s,r,i,n,t[a+10],17,-42063),n=this.md5_ff(n,s,r,i,t[a+11],22,-1990404162),i=this.md5_ff(i,n,s,r,t[a+12],7,1804603682),r=this.md5_ff(r,i,n,s,t[a+13],12,-40341101),s=this.md5_ff(s,r,i,n,t[a+14],17,-1502002290),n=this.md5_ff(n,s,r,i,t[a+15],22,1236535329),i=this.md5_gg(i,n,s,r,t[a+1],5,-165796510),r=this.md5_gg(r,i,n,s,t[a+6],9,-1069501632),s=this.md5_gg(s,r,i,n,t[a+11],14,643717713),n=this.md5_gg(n,s,r,i,t[a+0],20,-373897302),i=this.md5_gg(i,n,s,r,t[a+5],5,-701558691),r=this.md5_gg(r,i,n,s,t[a+10],9,38016083),s=this.md5_gg(s,r,i,n,t[a+15],14,-660478335),n=this.md5_gg(n,s,r,i,t[a+4],20,-405537848),i=this.md5_gg(i,n,s,r,t[a+9],5,568446438),r=this.md5_gg(r,i,n,s,t[a+14],9,-1019803690),s=this.md5_gg(s,r,i,n,t[a+3],14,-187363961),n=this.md5_gg(n,s,r,i,t[a+8],20,1163531501),i=this.md5_gg(i,n,s,r,t[a+13],5,-1444681467),r=this.md5_gg(r,i,n,s,t[a+2],9,-51403784),s=this.md5_gg(s,r,i,n,t[a+7],14,1735328473),n=this.md5_gg(n,s,r,i,t[a+12],20,-1926607734),i=this.md5_hh(i,n,s,r,t[a+5],4,-378558),r=this.md5_hh(r,i,n,s,t[a+8],11,-2022574463),s=this.md5_hh(s,r,i,n,t[a+11],16,1839030562),n=this.md5_hh(n,s,r,i,t[a+14],23,-35309556),i=this.md5_hh(i,n,s,r,t[a+1],4,-1530992060),r=this.md5_hh(r,i,n,s,t[a+4],11,1272893353),s=this.md5_hh(s,r,i,n,t[a+7],16,-155497632),n=this.md5_hh(n,s,r,i,t[a+10],23,-1094730640),i=this.md5_hh(i,n,s,r,t[a+13],4,681279174),r=this.md5_hh(r,i,n,s,t[a+0],11,-358537222),s=this.md5_hh(s,r,i,n,t[a+3],16,-722521979),n=this.md5_hh(n,s,r,i,t[a+6],23,76029189),i=this.md5_hh(i,n,s,r,t[a+9],4,-640364487),r=this.md5_hh(r,i,n,s,t[a+12],11,-421815835),s=this.md5_hh(s,r,i,n,t[a+15],16,530742520),n=this.md5_hh(n,s,r,i,t[a+2],23,-995338651),i=this.md5_ii(i,n,s,r,t[a+0],6,-198630844),r=this.md5_ii(r,i,n,s,t[a+7],10,1126891415),s=this.md5_ii(s,r,i,n,t[a+14],15,-1416354905),n=this.md5_ii(n,s,r,i,t[a+5],21,-57434055),i=this.md5_ii(i,n,s,r,t[a+12],6,1700485571),r=this.md5_ii(r,i,n,s,t[a+3],10,-1894986606),s=this.md5_ii(s,r,i,n,t[a+10],15,-1051523),n=this.md5_ii(n,s,r,i,t[a+1],21,-2054922799),i=this.md5_ii(i,n,s,r,t[a+8],6,1873313359),r=this.md5_ii(r,i,n,s,t[a+15],10,-30611744),s=this.md5_ii(s,r,i,n,t[a+6],15,-1560198380),n=this.md5_ii(n,s,r,i,t[a+13],21,1309151649),i=this.md5_ii(i,n,s,r,t[a+4],6,-145523070),r=this.md5_ii(r,i,n,s,t[a+11],10,-1120210379),s=this.md5_ii(s,r,i,n,t[a+2],15,718787259),n=this.md5_ii(n,s,r,i,t[a+9],21,-343485551),i=this.safe_add(i,o),n=this.safe_add(n,h),s=this.safe_add(s,l),r=this.safe_add(r,c)}return[i,n,s,r]},i.md5_cmn=function(t,e,i,n,s,r){return this.safe_add(this.bit_rol(this.safe_add(this.safe_add(e,t),this.safe_add(n,r)),s),i)},i.md5_ff=function(t,e,i,n,s,r,a){return this.md5_cmn(e&i|~e&n,t,e,s,r,a)},i.md5_gg=function(t,e,i,n,s,r,a){return this.md5_cmn(e&n|i&~n,t,e,s,r,a)},i.md5_hh=function(t,e,i,n,s,r,a){return this.md5_cmn(e^i^n,t,e,s,r,a)},i.md5_ii=function(t,e,i,n,s,r,a){return this.md5_cmn(i^(e|~n),t,e,s,r,a)},i.safe_add=function(t,e){var i=(65535&t)+(65535&e),n=(t>>16)+(e>>16)+(i>>16);return n<<16|65535&i},i.bit_rol=function(t,e){return t<<e|t>>>32-e},t}();egret.registerClass(md5,"md5");var ControllerConst;!function(t){t[t.Loading=1]="Loading",t[t.Game=2]="Game"}(ControllerConst||(ControllerConst={}));var SceneConst;!function(t){t[t.Loading=1]="Loading",t[t.Game=2]="Game"}(SceneConst||(SceneConst={}));var ViewConst;!function(t){t[t.Loading=1]="Loading",t[t.Game=2]="Game",t[t.GameUI=3]="GameUI"}(ViewConst||(ViewConst={}));var GameConst;!function(t){t[t.Jump=1]="Jump",t[t.Shoot=2]="Shoot",t[t.CeateBullet=3]="CeateBullet",t[t.RemoveBullet=4]="RemoveBullet",t[t.RemoveItem=5]="RemoveItem"}(GameConst||(GameConst={}));var GameController=function(t){function e(){t.call(this),GameManager.Init(),this.gameView=new GameView(this,LayerManager.Game_Main),App.ViewManager.register(ViewConst.Game,this.gameView),this.gameUIView=new GameUIView(this,LayerManager.Game_UI),App.ViewManager.register(ViewConst.GameUI,this.gameUIView),this.registerFunc(GameConst.Jump,this.gameView.Jump,this.gameView),this.registerFunc(GameConst.Shoot,this.gameView.Shoot,this.gameView),this.registerFunc(GameConst.CeateBullet,this.gameView.CreateBullet,this.gameView),this.registerFunc(GameConst.RemoveBullet,this.gameView.RemoveBullet,this.gameView),this.registerFunc(GameConst.RemoveItem,this.gameView.RemoveItem,this.gameView)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.CheckEnemyPosByHero=function(t){var e=this.gameView.GetHero();return e.y-t.y<-10?1:e.y-t.y>10?-1:0},n.CheckHitHero=function(t){var e=[],i=[];i=t.side==Side.Own?this.gameView.GetEnemies():[this.gameView.GetHero()];for(var n=0;n<i.length;n++){var s=i[n];this.hitTest(t.rect,s.rect)&&!t.CheckIgnore(s)&&(e.push(s),s.Hurt(t.GetDamage()),t.DoEffect(s))}return e},n.CheckHitItem=function(t){for(var e=!1,i=this.gameView.GetItems(),n=0;n<i.length;n++){var s=i[n];this.hitTest(t.rect,s.rect)&&(e=!0,App.ControllerManager.applyFunc(ControllerConst.Game,GameConst.RemoveItem,s),t.GetCreater().ChangeGun(s.GetAward()))}return e},n.CheckHeroOut=function(t){return t.y-t.anchorOffsetY<this.gameView.min_y?(t.y=this.gameView.min_y+t.anchorOffsetY,!0):t.y-t.anchorOffsetY+t.height>this.gameView.max_y?(t.y=this.gameView.max_y+t.anchorOffsetY-t.height,!0):!1},n.CheckOutScreen=function(t){return!this.hitTest(new egret.Rectangle(t.x,t.y,t.width,t.height),new egret.Rectangle(0,0,App.StageUtils.getWidth(),App.StageUtils.getHeight()))},n.hitTest=function(t,e){return t.intersects(e)},e}(BaseController);egret.registerClass(GameController,"GameController");var GameManager=function(){function t(){}var e=__define,i=t;i.prototype;return t.Init=function(){var t=RES.getRes("game_json");this.ui_h=t.ui_h;for(var e=t.heroes,i=t.guns,n=t.bullets,s=t.items,r=0;r<e.length;r++){var a=e[r];this.heroDic[a.id]=a}for(var r=0;r<i.length;r++){var o=i[r];this.gunDic[o.id]=o}for(var r=0;r<n.length;r++){var h=n[r];this.bulletDic[h.id]=h}for(var r=0;r<s.length;r++){var l=s[r];this.itemDic[l.id]=l}},t.GetHeroData=function(t){return this.heroDic[t]},t.GetGunData=function(t){return this.gunDic[t]},t.GetBulletData=function(t){return this.bulletDic[t]},t.GetItemData=function(t){return this.itemDic[t]},e(t,"UI_H",function(){return this.ui_h}),t.heroDic={},t.gunDic={},t.bulletDic={},t.itemDic={},t}();egret.registerClass(GameManager,"GameManager");var GameUIView=function(t){function e(e,i){t.call(this,e,i),this.width=App.StageUtils.getWidth(),this.y=App.StageUtils.getHeight()}__extends(e,t);var i=(__define,e),n=i.prototype;return n.initUI=function(){t.prototype.initUI.call(this),this.bg=App.DisplayUtils.createBitmap("bottom_png"),AnchorUtil.setAnchorY(this.bg,1),this.bg.name="bg",this.addChild(this.bg),this.jumpBtn=this.createBtn("btn_jump_png",180,-this.bg.height/2,this.jumpBtnUp,this.jumpBtnDown,this),this.jumpBtn.name="jumpBtn",this.addChild(this.jumpBtn),this.shootBtn=this.createBtn("btn_shoot_png",this.width-180,-this.bg.height/2,this.shootBtnUp,this.shootBtnDown,this),this.shootBtn.name="shootBtn",this.addChild(this.shootBtn),App.KeyboardUtils.addKeyUp(this.onKeyUp,this),App.KeyboardUtils.addKeyDown(this.onKeyDown,this)},n.initData=function(){t.prototype.initData.call(this)},n.jumpBtnDown=function(){this.jumpBtn.scaleX=this.jumpBtn.scaleY=.9,App.ControllerManager.applyFunc(ControllerConst.Game,GameConst.Jump,!0)},n.jumpBtnUp=function(){this.jumpBtn.scaleX=this.jumpBtn.scaleY=1,App.ControllerManager.applyFunc(ControllerConst.Game,GameConst.Jump,!1)},n.shootBtnDown=function(){this.shootBtn.scaleX=this.shootBtn.scaleY=.9,App.ControllerManager.applyFunc(ControllerConst.Game,GameConst.Shoot)},n.shootBtnUp=function(){this.shootBtn.scaleX=this.shootBtn.scaleY=1},n.onKeyDown=function(t){switch(t){case Keyboard.W:this.jumpBtnDown();break;case Keyboard.K:this.shootBtnDown();break;case Keyboard.SPACE:App.TimerManager.setTimeScale(.01);break;case Keyboard.J:App.TimerManager.setTimeScale(1)}},n.onKeyUp=function(t){switch(t){case Keyboard.W:this.jumpBtnUp();break;case Keyboard.K:this.shootBtnUp()}},n.createBtn=function(t,e,i,n,s,r){var a=App.DisplayUtils.createBitmap(t);a.touchEnabled=!0,AnchorUtil.setAnchor(a,.5);var o=new egret.Sprite;o.width=10*a.width,o.height=App.StageUtils.getHeight(),o.x=e,o.y=-o.height/2,o.touchEnabled=!0,AnchorUtil.setAnchor(o,.5);var h=new egret.Shape;return h.graphics.beginFill(16777215,0),h.graphics.drawRect(0,0,o.width,o.height),h.graphics.endFill(),o.addChild(h),this.addChild(o),a.touchEnabled=!1,o.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){s.call(r)},this),o.addEventListener(egret.TouchEvent.TOUCH_END,function(){n.call(r)},this),o.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,function(){n.call(r)},this),a.x=e,a.y=i,a},e}(BaseSpriteView);egret.registerClass(GameUIView,"GameUIView");var GameView=function(t){function e(e,i){t.call(this,e,i),this.ownBullets=[],this.enemies=[],this.enemyBullets=[],this.items=[],this.itemInterval=5,this.itemCd=0,this.controller=e}__extends(e,t);var i=__define,n=e,s=n.prototype;return s.initUI=function(){t.prototype.initUI.call(this);var e=App.DisplayUtils.createBitmap("bg_png");this.addChild(e),this.width=App.StageUtils.getWidth(),this.height=App.StageUtils.getHeight(),this.createHero(),this.createEnemy(AiType.Follow),App.TimerManager.doFrame(1,0,this.update,this)},s.initData=function(){t.prototype.initData.call(this)},s.update=function(t){var e=t/1e3;this.itemCd-=e,this.itemCd<=0&&(this.createItem(App.RandomUtils.limitInteger(1,5)),this.itemCd=this.itemInterval)},s.createHero=function(){this.hero=ObjectPool.pop("Hero",this.controller),this.hero.init(1,Side.Own);var t=this.getPerPos(.18,.3);this.hero.x=t.x,this.hero.y=t.y,this.addChild(this.hero)},s.createEnemy=function(t){var e=ObjectPool.pop("Hero",this.controller);e.init(1,Side.Enemy),e.SetAI(t);var i=this.getPerPos(.82,.3);e.x=i.x,e.y=i.y,this.addChild(e),this.enemies.push(e)},s.CreateBullet=function(t,e,i,n,s,r){var a=ObjectPool.pop(e,this.controller);a.init(t,i,r),a.x=n,a.y=s,i.side==Side.Own?this.ownBullets.push(a):i.side==Side.Enemy&&this.enemyBullets.push(a),this.addChild(a)},s.RemoveBullet=function(t){if(t.side==Side.Own){var e=this.ownBullets.indexOf(t);this.ownBullets.splice(e,1)}else if(t.side=Side.Enemy){var e=this.enemyBullets.indexOf(t);this.enemyBullets.splice(e,1)}t.destory()},s.createItem=function(t){var e=ObjectPool.pop("Item",this.controller),i=App.RandomUtils.limitInteger(0,1);e.init(t,Side.Middle,i);var n=this.getPerPos(App.RandomUtils.limit(.4,.6),i);e.x=n.x,e.y=n.y,this.addChild(e),this.items.push(e)},s.RemoveItem=function(t){var e=this.items.indexOf(t);this.items.splice(e,1),t.destory()},s.Jump=function(t){this.hero.IsUp=t},s.Shoot=function(){this.hero.Shoot()},s.GetHero=function(){return this.hero},s.GetEnemies=function(){return this.enemies},s.GetItems=function(){return this.items},i(s,"min_x",function(){return 0}),i(s,"max_x",function(){return App.StageUtils.getWidth()}),i(s,"min_y",function(){return 0}),i(s,"max_y",function(){return App.StageUtils.getHeight()-GameManager.UI_H}),s.getPerPos=function(t,e){var i=new egret.Point;return i.x=(this.max_x-this.min_x)*t+this.min_x,i.y=(this.max_y-this.min_y)*e+this.min_y,i},e}(BaseSpriteView);egret.registerClass(GameView,"GameView");var BulletData=function(){function t(){}var e=(__define,t);e.prototype;return t}();egret.registerClass(BulletData,"BulletData");var GunData=function(){function t(){}var e=(__define,t);e.prototype;return t}();egret.registerClass(GunData,"GunData");var GunType;!function(t){t[t.Normal=1]="Normal",t[t.Running=2]="Running",t[t.Shot=3]="Shot",t[t.Boomerang=4]="Boomerang",t[t.Laser=5]="Laser",t[t.Freez=6]="Freez"}(GunType||(GunType={}));var HeroData=function(){function t(){}var e=(__define,t);e.prototype;return t}();egret.registerClass(HeroData,"HeroData");var ItemData=function(){function t(){}var e=(__define,t);e.prototype;return t}();egret.registerClass(ItemData,"ItemData");var MoveData=function(){function t(t){this.direction=t}var e=(__define,t);e.prototype;return t}();egret.registerClass(MoveData,"MoveData");var BaseGameObject=function(t){function e(e){t.call(this),this.controller=e}__extends(e,t);var i=__define,n=e,s=n.prototype;return s.init=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];this._side=t,AnchorUtil.setAnchor(this,.5),App.TimerManager.doFrame(1,0,this.onFrame,this)},s.destory=function(){App.TimerManager.remove(this.onFrame,this),App.DisplayUtils.removeFromParent(this),ObjectPool.push(this)},s.onFrame=function(t){this.update(t)},s.update=function(t){},i(s,"gameController",function(){return this.controller}),i(s,"side",function(){return this._side}),i(s,"rect",function(){return new egret.Rectangle(this.x-this.width/2,this.y-this.width/2,this.width,this.height)}),e}(egret.DisplayObjectContainer);egret.registerClass(BaseGameObject,"BaseGameObject");var Side;!function(t){t[t.Own=0]="Own",t[t.Enemy=1]="Enemy",t[t.Middle=2]="Middle"}(Side||(Side={}));var Bullet=function(t){function e(e){t.call(this,e),this.mPoints=[]}__extends(e,t);var i=(__define,e),n=i.prototype;return n.init=function(e,i,n){t.prototype.init.call(this,i.side),this.id=e,this.creater=i,this.side==Side.Own?this.scaleX=1:this.side==Side.Enemy&&(this.scaleX=-1),this.moveData=n,this.rotation=n.direction,this.bulletData=GameManager.GetBulletData(e),this.speed=this.bulletData.speed,this.ignoreHeroes=[],null==this.sh&&(this.sh=new egret.Shape,this.creater.parent.addChild(this.sh),this.mg=this.sh.graphics)},n.setImg=function(t){null==this.img&&(this.img=new egret.Bitmap,this.addChild(this.img)),this.img.rotation=0,this.img.texture=RES.getRes(t),this.img.x=this.bulletData.width/2,this.img.y=this.bulletData.height/2,this.img.anchorOffsetX=this.img.width/2,this.img.anchorOffsetY=this.img.height/2},n.update=function(e){t.prototype.update.call(this,e),null!=this.bulletData.trail&&this.drawTrail(this.bulletData.trail);var i=e/1e3;this.x+=this.speed*i*Math.cos(this.rotation/180*Math.PI)*this.scaleX,this.y+=this.speed*i*Math.sin(this.rotation/180*Math.PI)*this.scaleX},n.remove=function(){App.ControllerManager.applyFunc(ControllerConst.Game,GameConst.RemoveBullet,this)},n.drawTrail=function(t){var e=.5*this.height,i={sx:this.x,sy:this.y,size:e};if(this.mPoints.push(i),0!=this.mPoints.length){this.mg.clear();for(var n=this.mPoints.length,s=0;n>s;s++){var r=this.mPoints[s];r.size-=1,r.size<.2*this.height&&(this.mPoints.splice(s,1),s--,n=this.mPoints.length)}n=this.mPoints.length;var a=.1;for(s=1;n>s;s++)for(var o=this.mPoints[s],h=5,l=this.mPoints[s-1].sx,c=this.mPoints[s-1].sy,u=o.sx,g=o.sy,d=this.mPoints[s-1].size,f=o.size,p=0;h>p;p++)this.mg.lineStyle(d+(f-d)/h*p,t,a),this.mg.moveTo(l+(u-l)/h*p,c+(g-c)/h*p),this.mg.lineTo(l+(u-l)/h*(p+1),c+(g-c)/h*(p+1)),a+=.002}},n.clearMg=function(){this.mg.clear(),this.mPoints=[]},n.destory=function(){t.prototype.destory.call(this),this.clearMg()},n.CheckIgnore=function(t){return this.ignoreHeroes.indexOf(t)>=0},n.GetDamage=function(){return this.bulletData.damage},n.GetCreater=function(){return this.creater},n.DoEffect=function(t){},e}(BaseGameObject);egret.registerClass(Bullet,"Bullet");var BoomerangBullet=function(t){function e(e){t.call(this,e)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.init=function(e,i,n){t.prototype.init.call(this,e,i,n),t.prototype.setImg.call(this,this.bulletData.img),this.width=this.bulletData.width,this.height=this.bulletData.height,this.state=0},n.update=function(e){switch(t.prototype.update.call(this,e),this.state){case 0:this.speed-=.9*e,this.speed<=700&&(this.state=1,this.ignoreHeroes=[]);break;case 1:this.speed+=.9*e;var i=App.MathUtils.getRadian2(this.x,this.y,this.creater.x,this.creater.y);-1==this.scaleX&&(i=App.MathUtils.getRadian2(this.creater.x,this.creater.y,this.x,this.y));var n=App.MathUtils.getAngle(i);this.rotation=n,this.rect.intersects(this.creater.rect)&&(this.remove(),this.creater.GunReturn());break;case 2:this.speed+=e;var s=90,r=this.rotation;this.rotation<0&&(r+=360),-1==this.scaleX&&(s=-90,r>180&&(s=270)),r>s?this.rotation=Math.max(s,r-e/5):this.rotation=Math.min(s,r+e/5)}var a=this.gameController.CheckHitHero(this),o=this.gameController.CheckHitItem(this),h=this.gameController.CheckOutScreen(this);if(this.img.rotation+=e,o?this.state=2:h&&this.remove(),a.length>0)for(var l=0;l<a.length;l++)this.ignoreHeroes.push(a[l])},e}(Bullet);egret.registerClass(BoomerangBullet,"BoomerangBullet");var NormalBullet=function(t){function e(e){t.call(this,e)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.init=function(e,i,n){t.prototype.init.call(this,e,i,n),t.prototype.setImg.call(this,this.bulletData.img),this.width=this.bulletData.width,this.height=this.bulletData.height},n.update=function(e){t.prototype.update.call(this,e);var i=this.gameController.CheckHitHero(this),n=this.gameController.CheckHitItem(this),s=this.gameController.CheckOutScreen(this);(i.length>0||n||s)&&this.remove()},e}(Bullet);egret.registerClass(NormalBullet,"NormalBullet");var FreezBullet=function(t){function e(){t.apply(this,arguments)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.DoEffect=function(t){t.Freez()},e}(NormalBullet);egret.registerClass(FreezBullet,"FreezBullet");var Hero=function(t){function e(e){t.call(this,e),this.hpArr=[]}__extends(e,t);var i=__define,n=e,s=n.prototype;return s.init=function(e,i){t.prototype.init.call(this,i),this.id=e,this.side==Side.Own?this.scaleX=1:this.side==Side.Enemy&&(this.scaleX=-1),this.heroData=GameManager.GetHeroData(e),this.width=this.heroData.width,this.height=this.heroData.height,this.anchorOffsetX=this.width/2,this.anchorOffsetY=this.height/2,this.setAnim(this.heroData.anim),this.setGun(this.heroData.gun),this.isUp=!1,this.speed=0,this.hp=0,this.addHp(this.heroData.hp),this.state=HeroState.Idle},s.SetAI=function(t){this.aiType=t},s.ChangeGun=function(t){this.setGun(t)},s.setAnim=function(t){null==this.anim&&(this.anim=new egret.MovieClip,this.anim.scaleX=this.anim.scaleY=.8,this.anim.anchorOffsetX=-this.width/2/.8,this.anim.anchorOffsetY=-this.height/.8,this.addChild(this.anim));var e=RES.getRes("hero_json"),i=RES.getRes("hero_png"),n=new egret.MovieClipDataFactory(e,i);this.anim.movieClipData=n.generateMovieClipData(t),this.anim.gotoAndPlay(1,-1)},s.setGun=function(t){null==this.gun&&(this.gun=new egret.Bitmap,this.gun.x=this.heroData.gunX,this.gun.y=this.heroData.gunY,this.addChild(this.gun)),this.gun.visible=!0,this.gunData=GameManager.GetGunData(t),this.gun.texture=RES.getRes(this.gunData.img),this.shootCd=this.gunData.interval},s.addHp=function(t){for(var e=function(t){var e;i.hpArr.length>t?e=i.hpArr[t]:(e=new egret.Shape,e.graphics.beginFill(16711935),e.graphics.drawRect(0,0,20,15),e.graphics.endFill(),e.x=-40,e.y=25*t,i.addChild(e),i.hpArr.push(e)),e.visible=!0,e.scaleX=e.scaleY=.01,egret.setTimeout(function(){egret.Tween.get(e).to({scaleX:1,scaleY:1},300,egret.Ease.elasticOut)},i,200*t)},i=this,n=this.hp;n<this.hp+t;n++)e(n);this.hp+=t},s.subHp=function(t){for(var e=function(t){var e=i.hpArr[t];egret.setTimeout(function(){egret.Tween.get(e).to({scaleX:.01,scaleY:.01},300,egret.Ease.elasticOut).call(function(){e.visible=!1})},i,200*(i.hp-1-t))},i=this,n=this.hp-1;n>=Math.max(0,this.hp-t);n--)e(n);this.hp=Math.max(0,this.hp-t)},s.showFreez=function(t){null==this.freezImg&&(this.freezImg=App.DisplayUtils.createBitmap("freez_png"),this.addChild(this.freezImg),this.freezImg.anchorOffsetX=this.freezImg.width/2,this.freezImg.anchorOffsetY=this.freezImg.height/2),this.freezImg.x=this.width/2,this.freezImg.y=this.height/2,this.freezImg.visible=t},s.Shoot=function(){var t=this;if(this.state==HeroState.Idle&&this.shootCd<=0){var e=this.gunData.bullet,i=function(i,n){var s=t.x+(t.gun.x+t.gunData.bulletX-t.anchorOffsetX)*t.scaleX,r=t.y-t.anchorOffsetY+t.gun.y+t.gunData.bulletY,a=new MoveData(n);App.ControllerManager.applyFunc(ControllerConst.Game,GameConst.CeateBullet,e,i,t,s,r,a)};switch(this.gunData.type){case GunType.Normal:i("NormalBullet",0),this.shootCd=this.gunData.interval;break;case GunType.Running:var n=this.gunData.info,s=n.count,r=1e3*n.interval;App.TimerManager.doTimer(r,s,function(){return i("NormalBullet",0)},this),this.ResetGun();break;case GunType.Shot:for(var n=this.gunData.info,s=n.count,a=n.angle,o=-(s-1)/2*a,h=0;s>h;h++)i("NormalBullet",o+h*a);this.ResetGun();break;case GunType.Boomerang:this.gun.visible=!1,i("BoomerangBullet",0),this.shootCd=100;break;case GunType.Laser:i("LaserBullet",0),this.shootCd=100;break;case GunType.Freez:i("FreezBullet",0),this.ResetGun()}}},s.GunReturn=function(){this.gun.visible=!0,this.shootCd=this.gunData.interval},s.ResetGun=function(){this.ChangeGun(this.heroData.gun)},s.Hurt=function(t){App.ShockUtils.shock(App.ShockUtils.SPRITE,this,1),this.state=HeroState.Hurt,this.hurtTime=0,this.subHp(t)},s.Freez=function(){this.state=HeroState.Freez,this.freezTime=.5},s.update=function(e){t.prototype.update.call(this,e);var i=e/1e3;if(this.shootCd>0&&(this.shootCd-=i),this.state==HeroState.Hurt&&(this.hurtTime-=i,this.hurtTime<=0&&(this.state=HeroState.Idle)),this.state==HeroState.Freez&&(this.isUp=!1,this.freezTime-=i,this.showFreez(!0),this.speed=0,this.freezTime<=0&&(this.state=HeroState.Idle,this.showFreez(!1))),this.side==Side.Enemy)switch(this.aiType){case AiType.Follow:this.followAi()}var n=this.heroData.downAs;this.isUp&&(n=this.heroData.upAs);var s=this.speed;this.speed=Math.max(Math.min(this.speed+n*i,this.heroData.maxSpeed),this.heroData.minSpeed),this.y-=(s+this.speed)/2*i,this.gameController.CheckHeroOut(this)&&(this.speed=0)},i(s,"IsUp",void 0,function(t){this.isUp=t}),s.followAi=function(){var t=this.gameController.CheckEnemyPosByHero(this);t>0?this.isUp=!0:(this.isUp=!1,0==t&&this.Shoot())},s.GetState=function(){return this.state},e}(BaseGameObject);egret.registerClass(Hero,"Hero");var HeroState;!function(t){t[t.Idle=0]="Idle",t[t.Hurt=1]="Hurt",t[t.Freez=2]="Freez"}(HeroState||(HeroState={}));var AiType;!function(t){t[t.Follow=0]="Follow"}(AiType||(AiType={}));var Item=function(t){function e(e){t.call(this,e)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.init=function(e,i,n){t.prototype.init.call(this,i),this.id=e,this.direction=n;var s=GameManager.GetItemData(e);this.speed=s.speed,this.awardGun=s.awardGun,this.width=60,this.height=60;var r=new egret.Shape;r.graphics.beginFill(16776960),r.graphics.drawRect(0,0,60,60),r.graphics.endFill(),this.addChild(r)},n.update=function(e){t.prototype.update.call(this,e);var i=e/1e3;0==this.direction?this.y+=this.speed*i:this.y-=this.speed*i,this.gameController.CheckOutScreen(this)&&App.ControllerManager.applyFunc(ControllerConst.Game,GameConst.RemoveItem,this)},n.GetAward=function(){return this.awardGun},e}(BaseGameObject);egret.registerClass(Item,"Item");var LaserBullet=function(t){function e(e){t.call(this,e)}__extends(e,t);var i=__define,n=e,s=n.prototype;return s.init=function(e,i,n){t.prototype.init.call(this,e,i,n),AnchorUtil.setAnchor(this,0),this.state=0,this.speed=0;var s=this.bulletData.info;this.readyTime=s.readyTime,this.releaseTime=s.releaseTime,this.readCd=this.readyTime,this.setReadyImg(s.ready),this.setImg(this.bulletData.img),this.readyImg.scaleX=this.readyImg.scaleY=.5,this.createrX=this.creater.x,this.createrY=this.creater.y,this.alpha=1},s.setReadyImg=function(t){null==this.readyImg&&(this.readyImg=new egret.Bitmap,this.addChild(this.readyImg),AnchorUtil.setAnchor(this.readyImg,.5)),this.readyImg.texture=RES.getRes(t),this.readyImg.x=this.readyImg.width/2},s.setImg=function(t){null==this.img&&(this.img=new egret.Bitmap,this.addChild(this.img),AnchorUtil.setAnchorY(this.img,.5)),this.img.texture=RES.getRes(t),this.img.scale9Grid=new egret.Rectangle(100,0,200,this.img.height),this.img.width=0},s.update=function(e){t.prototype.update.call(this,e),this.x+=this.creater.x-this.createrX,this.y+=this.creater.y-this.createrY,this.createrX=this.creater.x,this.createrY=this.creater.y;var i=e/1e3;switch(this.state){case 0:this.readCd-=i,this.readCd>0?1==this.readyImg.scaleX?this.readyImg.scaleX=this.readyImg.scaleY=.5:this.readyImg.scaleX=this.readyImg.scaleY=1:(this.state=1,this.img.scaleY=this.readyImg.scaleX=this.readyImg.scaleY=.5,this.img.x=this.readyImg.x+this.readyImg.width*this.readyImg.scaleX*.23-5,this.creater.ResetGun());break;case 1:this.img.scaleY=this.readyImg.scaleX=this.readyImg.scaleY+=.5/this.releaseTime*i,this.img.x=this.readyImg.x+this.readyImg.width*this.readyImg.scaleX*.23-5,this.img.width+=this.bulletData.width/this.releaseTime*i,this.img.scaleY>=1&&(this.state=2);break;case 2:this.img.scaleY=this.readyImg.scaleX=this.readyImg.scaleY-=2*i,this.img.x=this.readyImg.x+this.readyImg.width*this.readyImg.scaleX*.23-5,this.img.scaleY<=.1&&this.remove()}var n=this.gameController.CheckHitHero(this);this.gameController.CheckHitItem(this),this.gameController.CheckOutScreen(this);if(n.length>0)for(var s=0;s<n.length;s++)this.ignoreHeroes.push(n[s])},i(s,"rect",function(){var t,e=this.img.width,i=this.img.height*this.img.scaleY;return t=1==this.scaleX?new egret.Rectangle(this.x+this.img.x,this.y-i/2,e,i):new egret.Rectangle(this.x-this.img.x-e,this.y-i/2,e,i)}),e}(Bullet);egret.registerClass(LaserBullet,"LaserBullet");var LoadingConst;!function(t){t[t.SetProgress=1]="SetProgress"}(LoadingConst||(LoadingConst={}));var LoadingController=function(t){function e(){t.call(this),this.loadingView=new LoadingView(this,LayerManager.UI_Main),App.ViewManager.register(ViewConst.Loading,this.loadingView),this.registerFunc(LoadingConst.SetProgress,this.setProgress,this)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.setProgress=function(t,e){this.loadingView.setProgress(t,e)},e}(BaseController);egret.registerClass(LoadingController,"LoadingController");var LoadingView=function(t){function e(e,i){t.call(this,e,i),this.skinName=LoadingSceneSkin}__extends(e,t);var i=(__define,e),n=i.prototype;return n.setProgress=function(t,e){this.progress.text="加载中...("+t+"/"+e+")"},e}(BaseEuiView);egret.registerClass(LoadingView,"LoadingView");var GameScene=function(t){function e(){t.call(this)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.onEnter=function(){t.prototype.onEnter.call(this),this.addLayer(LayerManager.Game_Main),this.addLayer(LayerManager.Game_UI),App.ViewManager.open(ViewConst.Game),App.ViewManager.open(ViewConst.GameUI)},n.onExit=function(){t.prototype.onExit.call(this)},e}(BaseScene);egret.registerClass(GameScene,"GameScene");var LayerManager=function(){function t(){}var e=(__define,t);e.prototype;return t.Game_Main=new BaseSpriteLayer,t.Game_UI=new BaseSpriteLayer,t.UI_Main=new BaseEuiLayer,t.UI_Pop=new BaseEuiLayer,t.UI_Message=new BaseEuiLayer,t}();egret.registerClass(LayerManager,"LayerManager");var LoadingScene=function(t){function e(){t.call(this)}__extends(e,t);var i=(__define,e),n=i.prototype;return n.onEnter=function(){t.prototype.onEnter.call(this),this.addLayer(LayerManager.UI_Main),App.ViewManager.open(ViewConst.Loading)},n.onExit=function(){t.prototype.onExit.call(this)},e}(BaseScene);egret.registerClass(LoadingScene,"LoadingScene");